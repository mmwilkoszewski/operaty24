import React, { useState, useMemo, useEffect, createContext, useContext, ReactNode, useRef } from 'react';
import ReactDOM from 'react-dom/client';
import L, { LatLngExpression, Map as LeafletMap, Icon } from 'leaflet';
import { MapContainer, TileLayer, Marker, Popup, GeoJSON } from 'react-leaflet';
import { GoogleGenAI, Type } from "@google/genai";

// ================================================================================= //
// BUNDLED FROM: types.ts
// ================================================================================= //
interface AuditLogEntry {
  id: string;
  timestamp: string;
  userId: string;
  userEmail: string;
  action: string;
  details: string;
}
enum PropertyType {
  MIESZKANIE = 'Mieszkanie',
  DOM = 'Dom',
  DZIALKA = 'Działka',
  LOKAL_USLUGOWY = 'Lokal usługowy',
  INNY = 'Inny',
}
enum ValuationPurpose {
  KREDYT = 'Kredyt hipoteczny',
  SPRZEDAZ = 'Sprzedaż',
  PODZIAL_MAJATKU = 'Podział majątku',
  SPADEK = 'Postępowanie spadkowe',
  INNY = 'Inny',
}
enum UserRole {
  ADMIN = 'Admin',
  PRACOWNIK = 'Pracownik',
  RZECZOZNAWCA = 'Rzeczoznawca',
}
enum ZlecenieStatus {
    LEAD = 'Lead',
    DO_AKCEPTACJI = 'Do akceptacji',
    NOWE = 'Nowe',
    ZAREZERWOWANE = 'Zarezerwowane',
    W_TRAKCIE = 'W trakcie',
    DO_ROZLICZENIA = 'Do rozliczenia',
    ZAKONCZONE = 'Zakończone',
    ANULOWANE = 'Anulowane',
}
enum WorkInProgressSubStatus {
    OCZEKUJE_NA_OGLEDZINY = 'Oczekuje na oględziny',
    OGLEDZINY_WYKONANE = 'Oględziny wykonane',
    OPERAT_W_PRZYGOTOWANIU = 'Operat w przygotowaniu',
}
enum LeadSource {
  TELEFON = 'Telefon',
  EMAIL = 'Email',
  FORMULARZ = 'Formularz',
}
enum AppraisalForm {
  ELEKTRONICZNY = 'Elektroniczny',
  PAPIEROWY = 'Papierowy',
  OBYDWA = 'Obydwa',
}
type SortOption = 'date_desc' | 'date_asc' | 'price_asc' | 'price_desc' | 'default';
interface User {
  id: string;
  email: string;
  password: string;
  role: UserRole;
  firstName: string;
  lastName: string;
  city?: string;
  assignedVoivodeships?: string[];
  phone?: string;
  notificationPreferences?: {
    newOrders: ('email' | 'sms')[];
    statusChanges: ('email' | 'sms')[];
  }
}
interface Settings {
    notificationEmail: string;
    propertyTypes: string[];
    valuationPurposes: string[];
    orderStatusColors: Partial<Record<ZlecenieStatus, string>>;
    notificationTemplates: {
        orderAccepted: string;
        orderCancelled: string;
        orderUpdated: string;
    };
}
interface Coordinates {
  lat: number;
  lng: number;
}
interface GeocodeResult {
  coordinates: Coordinates;
  voivodeship: string;
}
interface AppraiserResponse {
  id: string;
  authorId: string;
  author: string;
  proposedPrice?: number;
  completionDate: string;
  questions: string;
  status: 'accepted' | 'counter-offer';
}
interface CommunicationEntry {
  id: string;
  date: string;
  author: string;
  content: string;
}
interface FileAttachment {
  id: string;
  name: string;
  size: number;
  type: string;
  url: string;
  uploadedAt: string;
}
interface SettlementChecklist {
    operatPobrany: boolean;
    fakturaWystawiona: boolean;
    fakturaOplacona: boolean;
    operatPrzekazany: boolean;
    rozliczonoZRzeczoznawca: boolean;
}
interface ClientDetails {
    fullName: string;
    phone: string;
    email?: string;
    appraisalForm: AppraisalForm;
}
interface Zlecenie {
    id: string;
    creationDate: string;
    publicationDate?: string;
    status: ZlecenieStatus;
    subStatus?: WorkInProgressSubStatus;
    source?: LeadSource;
    locationString: string;
    kwNumber?: string;
    coordinates?: Coordinates;
    voivodeship?: string;
    propertyType: string;
    valuationPurpose: string;
    clientDetails: ClientDetails;
    clientPrice?: number;
    proposedPrice?: number;
    proposedCompletionDate?: string;
    actualCompletionDate?: string;
    additionalNotes?: string;
    assignedAppraiserId?: string;
    responses: AppraiserResponse[];
    attachments: FileAttachment[];
    communicationLog: CommunicationEntry[];
    settlementChecklist?: SettlementChecklist;
}
interface Filters {
  propertyType: string[];
  valuationPurpose: string[];
  location: string;
  voivodeship: string | 'all';
  status: ZlecenieStatus[];
  sortBy: SortOption;
  quickSearch: string;
  assignedAppraiserId: string | 'all';
}
interface VoivodeshipData {
  center: LatLngExpression;
  zoom: number;
  geoJson: any;
}
interface Notification {
  id: string;
  timestamp: string;
  message: string;
  isRead: boolean;
  link?: {
    view: 'zlecenia';
    itemId: string;
  };
}

// ================================================================================= //
// BUNDLED FROM: constants.ts
// ================================================================================= //
const MapPinIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M15 10.5a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z'}),React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M19.5 10.5c0 7.142-7.5 11.25-7.5 11.25S4.5 17.642 4.5 10.5a7.5 7.5 0 1 1 15 0Z'}));
const BuildingOfficeIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M3.75 21h16.5M4.5 3h15M5.25 3v18m13.5-18v18M9 6.75h6m-6 3h6m-6 3h6m-6 3h6'}));
const ClipboardDocumentListIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M9 12h3.75M9 15h3.75M9 18h3.75m3 .75H18a2.25 2.25 0 0 0 2.25-2.25V6.108c0-1.135-.845-2.098-1.976-2.192a48.424 48.424 0 0 0-1.123-.08m-5.801 0c-.065.21-.1.433-.1.664 0 .414.336.75.75.75h4.5a.75.75 0 0 0 .75-.75 2.25 2.25 0 0 0-.1-.664m-5.8 0A2.251 2.251 0 0 1 5.25 6h.008a2.25 2.25 0 0 1 2.242 2.15 48.062 48.062 0 0 1 .814 8.246m-1.543-.824A2.25 2.25 0 0 0 6.75 15.75h.008a2.25 2.25 0 0 0 2.242 2.15 48.062 48.062 0 0 1 .814 8.246M12 4.5v15m0 0a2.25 2.25 0 0 1-2.25 2.25H6.75a2.25 2.25 0 0 1-2.25-2.25V6.75a2.25 2.25 0 0 1 2.25-2.25h3.75m0 15a2.25 2.25 0 0 0 2.25-2.25V6.75a2.25 2.25 0 0 0-2.25-2.25H6.75a2.25 2.25 0 0 0-2.25-2.25v13.5'}));
const BanknotesIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M2.25 18.75a60.07 60.07 0 0 1 15.797 2.101c.727.198 1.453-.342 1.453-1.096V18.75M3.75 4.5v.75A.75.75 0 0 1 3 6h-.75m0 0v-.375c0-.621.504-1.125 1.125-1.125H20.25M2.25 6v9m18-10.5v.75c0 .414.336.75.75.75h.75m-1.5-1.5h.375c.621 0 1.125.504 1.125 1.125v9.75c0 .621-.504 1.125-1.125 1.125h-.375m1.5-1.5H21a.75.75 0 0 0-.75.75v.75m0 0H3.75m0 0h-.375a1.125 1.125 0 0 1-1.125-1.125V15m1.5 1.5v-.75A.75.75 0 0 0 3 15h-.75M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z'}));
const CalendarDaysIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M6.75 3v2.25M17.25 3v2.25M3 18.75V7.5a2.25 2.25 0 0 1 2.25-2.25h13.5A2.25 2.25 0 0 1 21 7.5v11.25m-18 0A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75m-18 0h18M-4.5 12h22.5'}));
const DocumentMagnifyingGlassIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m5.231 13.481L15 17.25m-4.5-1.5V5.625c0-1.036.84-1.875 1.875-1.875h1.5c1.036 0 1.875.84 1.875 1.875v3.026a2.25 2.25 0 0 1-2.25 2.25h-1.5a2.25 2.25 0 0 1-2.25-2.25V5.625m2.25 11.812a2.25 2.25 0 0 1-2.25 2.25H8.25a2.25 2.25 0 0 1-2.25-2.25v-4.5a2.25 2.25 0 0 1 2.25-2.25h3.879a2.25 2.25 0 0 1 1.591.659l2.121 2.121a2.25 2.25 0 0 1 .659 1.591v3.879a2.25 2.25 0 0 1-2.25 2.25H9.75m-1.51-1.51.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.01-.01.d'}));
const PencilIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10'}));
const CheckCircleIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z'}));
const ClipboardDocumentCheckIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M10.125 2.25h-4.5c-1.125 0-2.25.9-2.25 2.25v15c0 1.125.9 2.25 2.25 2.25h10.5c1.125 0 2.25-.9 2.25-2.25v-13.5c0-1.125-.9-2.25-2.25-2.25h-4.5m-4.5 0v.75c0 .621.504 1.125 1.125 1.125h3.375c.621 0 1.125-.504 1.125-1.125v-.75m-4.5 0h4.5m1.875 11.25-1.5-1.5-1.5 1.5m-3-6.75h6.75'}));
const ChatBubbleLeftEllipsisIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M8.625 12a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H8.25m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0H12m4.125 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm0 0h-.375M21 12c0 4.556-4.03 8.25-9 8.25a9.764 9.764 0 0 1-2.555-.337A5.972 5.972 0 0 1 5.41 20.97a5.969 5.969 0 0 1-.474-.065 4.48 4.48 0 0 0 .978-2.025c.09-.455.09-.934.09-1.425 0-4.556 4.03-8.25 9-8.25s9 3.694 9 8.25Z'}));
const PaperClipIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'m18.375 12.739-7.693 7.693a4.5 4.5 0 0 1-6.364-6.364l10.94-10.94A3 3 0 1 1 19.5 7.372L8.552 18.32m.009-.01-.01.01m5.699-9.941-7.81 7.81a1.5 1.5 0 0 0 2.122 2.122l7.81-7.81'}));
const TrashIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.134-2.033-2.134H8.71c-1.123 0-2.033.954-2.033 2.134v.916m7.5 0a48.667 48.667 0 0 0-7.5 0'}));
const Cog6ToothIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z'}),React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M15 12a3 3 0 11-6 0 3 3 0 016 0z'}));
const ArrowRightStartOnRectangleIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M15.75 9V5.25A2.25 2.25 0 0 0 13.5 3h-6a2.25 2.25 0 0 0-2.25 2.25v13.5A2.25 2.25 0 0 0 7.5 21h6a2.25 2.25 0 0 0 2.25-2.25V15m-3 0h6m-6 0-3.375-3.375M12.75 15 9.375 11.625'}));
const BellIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M14.857 17.082a23.848 23.848 0 0 0 5.454-1.31A8.967 8.967 0 0 1 18 9.75V9A6 6 0 0 0 6 9v.75a8.967 8.967 0 0 1-2.312 6.022c1.733.64 3.56 1.085 5.455 1.31m5.714 0a24.255 24.255 0 0 1-5.714 0m5.714 0a3 3 0 1 1-5.714 0'}));
const ClockIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z'}));
const ArchiveBoxIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'m20.25 7.5-.625 10.632a2.25 2.25 0 0 1-2.247 2.118H6.622a2.25 2.25 0 0 1-2.247-2.118L3.75 7.5M10 11.25h4'}),React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M3.375 7.5h17.25c.621 0 1.125-.504 1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125Z'}));
const UserIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z'}));
const PlusCircleIcon = (props) => React.createElement('svg',{xmlns:'http://www.w3.org/2000/svg',fill:'none',viewBox:'0 0 24 24',strokeWidth:1.5,stroke:'currentColor',...props},React.createElement('path',{strokeLinecap:'round',strokeLinejoin:'round',d:'M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z'}));

const VOIVODESHIP_DATA = {'mazowieckie':{center:[52.237049,21.017532],zoom:8,geoJson:null},'małopolskie':{center:[49.839683,19.944979],zoom:8,geoJson:null},'śląskie':{center:[50.264892,19.023781],zoom:8,geoJson:null},'wielkopolskie':{center:[52.406376,16.925167],zoom:8,geoJson:null},'dolnośląskie':{center:[51.107883,17.038538],zoom:8,geoJson:null},'łódzkie':{center:[51.759247,19.457218],zoom:8,geoJson:null},'pomorskie':{center:[54.352024,18.646639],zoom:8,geoJson:null},'lubelskie':{center:[51.246452,22.568445],zoom:8,geoJson:null},'podkarpackie':{center:[50.041183,21.999121],zoom:8,geoJson:null},'kujawsko-pomorskie':{center:[53.013790,18.598444],zoom:8,geoJson:null},'zachodniopomorskie':{center:[53.428543,14.552812],zoom:8,geoJson:null},'warmińsko-mazurskie':{center:[53.778422,20.480119],zoom:8,geoJson:null},'świętokrzyskie':{center:[50.866077,20.628569],zoom:8,geoJson:null},'podlaskie':{center:[53.132489,23.168840],zoom:8,geoJson:null},'lubuskie':{center:[52.273552,15.506530],zoom:8,geoJson:null},'opolskie':{center:[50.675107,17.921298],zoom:8,geoJson:null}};
const PROPERTY_TYPES = Object.values(PropertyType);
const VALUATION_PURPOSES = Object.values(ValuationPurpose);
const ZLECENIE_STATUSES = Object.values(ZlecenieStatus);
const WORK_IN_PROGRESS_SUBSTATUSES = Object.values(WorkInProgressSubStatus);
const APPRAISAL_FORMS = Object.values(AppraisalForm);
const statusStyles = {[ZlecenieStatus.LEAD]:{dot:'bg-yellow-500',text:'text-yellow-700',bg:'bg-yellow-50',border:'border-yellow-200'},[ZlecenieStatus.DO_AKCEPTACJI]:{dot:'bg-orange-500',text:'text-orange-700',bg:'bg-orange-50',border:'border-orange-200'},[ZlecenieStatus.NOWE]:{dot:'bg-blue-500',text:'text-blue-700',bg:'bg-blue-50',border:'border-blue-200'},[ZlecenieStatus.ZAREZERWOWANE]:{dot:'bg-teal-500',text:'text-teal-700',bg:'bg-teal-50',border:'border-teal-200'},[ZlecenieStatus.W_TRAKCIE]:{dot:'bg-purple-500',text:'text-purple-700',bg:'bg-purple-50',border:'border-purple-200'},[ZlecenieStatus.DO_ROZLICZENIA]:{dot:'bg-cyan-500',text:'text-cyan-700',bg:'bg-cyan-50',border:'border-cyan-200'},[ZlecenieStatus.ZAKONCZONE]:{dot:'bg-green-500',text:'text-green-700',bg:'bg-green-50',border:'border-green-200'},[ZlecenieStatus.ANULOWANE]:{dot:'bg-gray-500',text:'text-gray-700',bg:'bg-gray-50',border:'border-gray-200'}};
const MOCK_USERS = [{id:'1',email:'admin@wyceny.pl',password:'admin',role:UserRole.ADMIN,firstName:'Adam',lastName:'Nowak',city:'Warszawa',phone:'111-222-333'},{id:'2',email:'rzeczoznawca1@firma.pl',password:'user',role:UserRole.RZECZOZNAWCA,firstName:'Jan',lastName:'Kowalski',city:'Warszawa',assignedVoivodeships:['mazowieckie'],phone:'123-456-789',notificationPreferences:{newOrders:['email'],statusChanges:['email','sms']}},{id:'3',email:'rzeczoznawca2@firma.pl',password:'user',role:UserRole.RZECZOZNAWCA,firstName:'Anna',lastName:'Wiśniewska',city:'Kraków',assignedVoivodeships:['małopolskie'],phone:'987-654-321',notificationPreferences:{newOrders:['sms'],statusChanges:['email']}},{id:'4',email:'pracownik@wyceny.pl',password:'user',role:UserRole.PRACOWNIK,firstName:'Piotr',lastName:'Zieliński',city:'Warszawa',phone:'444-555-666'}];
const tomorrow = new Date();
tomorrow.setDate(tomorrow.getDate()+10);
const MOCK_ZLECENIA = [{id:'1',creationDate:new Date(Date.now()-86400000*1).toISOString(),publicationDate:new Date(Date.now()-86400000*1).toISOString(),locationString:'ul. Marszałkowska 1, Warszawa',coordinates:{lat:52.23,lng:21.01},voivodeship:'mazowieckie',propertyType:PropertyType.MIESZKANIE,valuationPurpose:ValuationPurpose.KREDYT,proposedPrice:1000,status:ZlecenieStatus.NOWE,responses:[],proposedCompletionDate:tomorrow.toISOString().split('T')[0],communicationLog:[],attachments:[],clientDetails:{fullName:'Jan Nowak',phone:'111-000-111',appraisalForm:AppraisalForm.ELEKTRONICZNY}},{id:'3',creationDate:new Date(Date.now()-86400000*3).toISOString(),publicationDate:new Date(Date.now()-86400000*3).toISOString(),locationString:'Aleje Jerozolimskie 90, Warszawa',coordinates:{lat:52.228,lng:21},voivodeship:'mazowieckie',propertyType:PropertyType.LOKAL_USLUGOWY,valuationPurpose:ValuationPurpose.KREDYT,proposedPrice:2500,status:ZlecenieStatus.NOWE,responses:[],communicationLog:[],attachments:[],clientDetails:{fullName:'Firma XYZ',phone:'111-000-333',appraisalForm:AppraisalForm.ELEKTRONICZNY}},{id:'4',creationDate:new Date(Date.now()-86400000*32).toISOString(),publicationDate:new Date(Date.now()-86400000*32).toISOString(),locationString:'ul. Długa 4, Gdańsk',coordinates:{lat:54.34,lng:18.65},voivodeship:'pomorskie',propertyType:PropertyType.MIESZKANIE,valuationPurpose:ValuationPurpose.SPADEK,proposedPrice:900,status:ZlecenieStatus.ZAKONCZONE,responses:[],assignedAppraiserId:'2',actualCompletionDate:new Date(Date.now()-86400000*30).toISOString(),communicationLog:[],attachments:[],clientDetails:{fullName:'Anna Kowalska',phone:'111-000-444',appraisalForm:AppraisalForm.ELEKTRONICZNY}},{id:'5',creationDate:new Date(Date.now()-86400000*15).toISOString(),publicationDate:new Date(Date.now()-86400000*15).toISOString(),locationString:'Rynek Główny 1, Kraków',coordinates:{lat:50.061,lng:19.937},voivodeship:'małopolskie',propertyType:PropertyType.LOKAL_USLUGOWY,valuationPurpose:ValuationPurpose.SPRZEDAZ,proposedPrice:3200,status:ZlecenieStatus.DO_ROZLICZENIA,assignedAppraiserId:'3',actualCompletionDate:new Date(Date.now()-86400000*2).toISOString(),responses:[],communicationLog:[],attachments:[],settlementChecklist:{operatPobrany:true,fakturaWystawiona:true,fakturaOplacona:false,operatPrzekazany:false,rozliczonoZRzeczoznawca:false},clientDetails:{fullName:'Piotr Wiśniewski',phone:'111-000-555',appraisalForm:AppraisalForm.ELEKTRONICZNY}},{id:'6',creationDate:new Date(Date.now()-86400000*10).toISOString(),publicationDate:new Date(Date.now()-86400000*10).toISOString(),locationString:'ul. Piotrkowska 100, Łódź',coordinates:{lat:51.76,lng:19.45},voivodeship:'łódzkie',propertyType:PropertyType.MIESZKANIE,valuationPurpose:ValuationPurpose.PODZIAL_MAJATKU,proposedPrice:750,status:ZlecenieStatus.W_TRAKCIE,subStatus:WorkInProgressSubStatus.OGLEDZINY_WYKONANE,responses:[],assignedAppraiserId:'3',communicationLog:[],attachments:[],clientDetails:{fullName:'Katarzyna Zielińska',phone:'111-000-666',appraisalForm:AppraisalForm.ELEKTRONICZNY}},{id:'2',creationDate:new Date(Date.now()-86400000*3).toISOString(),publicationDate:new Date(Date.now()-86400000*2).toISOString(),status:ZlecenieStatus.ZAREZERWOWANE,source:LeadSource.FORMULARZ,locationString:'ul. Floriańska 15, Kraków',kwNumber:'KR1P/00055555/5',coordinates:{lat:50.06,lng:19.94},voivodeship:'małopolskie',propertyType:PropertyType.DOM,valuationPurpose:ValuationPurpose.SPRZEDAZ,clientDetails:{fullName:'Ewa Dąbrowska',phone:'602-333-444',email:undefined,appraisalForm:AppraisalForm.OBYDWA},clientPrice:2200,proposedPrice:1500,assignedAppraiserId:'3',responses:[{id:'resp1',authorId:'3',author:'rzeczoznawca2@firma.pl',completionDate:'2024-08-10',questions:'Czy jest dostęp do poddasza?',status:'accepted'}],communicationLog:[{id:'logL3-1',date:new Date(Date.now()-86400000*3).toISOString(),author:'System',content:'Lead utworzony.'},{id:'logL3-2',date:new Date(Date.now()-86400000*2).toISOString(),author:'System',content:'Lead skonwertowany na zlecenie #2.'},{id:'log1',date:new Date().toISOString(),author:'System',content:'Zlecenie utworzone z leada #L3.'}],attachments:[]},{id:'L1',creationDate:new Date(Date.now()-86400000*1).toISOString(),status:ZlecenieStatus.LEAD,source:LeadSource.TELEFON,clientDetails:{fullName:'Jan Kowalski (tel)',phone:'501-111-222',email:'jan.kowalski@example.com',appraisalForm:AppraisalForm.ELEKTRONICZNY},locationString:'ul. Słoneczna 10, Warszawa, Mokotów',kwNumber:'WA1M/00012345/6',propertyType:PropertyType.MIESZKANIE,valuationPurpose:ValuationPurpose.KREDYT,clientPrice:1200,proposedPrice:850,additionalNotes:'Pilne, klientowi zależy na czasie.',communicationLog:[{id:'logL1',date:new Date(Date.now()-86400000*1).toISOString(),author:'System',content:'Lead utworzony.'}],attachments:[],responses:[]},{id:'L4',creationDate:new Date(Date.now()-86400000*4).toISOString(),status:ZlecenieStatus.ANULOWANE,source:LeadSource.TELEFON,clientDetails:{fullName:'Klient Niezainteresowany',phone:'Brak danych',appraisalForm:AppraisalForm.ELEKTRONICZNY},locationString:'Poznań',propertyType:PropertyType.DOM,valuationPurpose:ValuationPurpose.INNY,clientPrice:0,additionalNotes:'Klient tylko pytał o orientacyjną cenę, nie był zainteresowany zleceniem.',communicationLog:[{id:'logL4-1',date:new Date(Date.now()-86400000*4).toISOString(),author:'System',content:'Lead utworzony.'},{id:'logL4-2',date:new Date(Date.now()-86400000*4).toISOString(),author:'System',content:'Zmieniono status na: Anulowane.'}],attachments:[],responses:[]},{id:'L9',creationDate:new Date(Date.now()-86400000*2.5).toISOString(),status:ZlecenieStatus.LEAD,source:LeadSource.TELEFON,clientDetails:{fullName:'Klient Garaż',phone:'222-444-666',appraisalForm:AppraisalForm.ELEKTRONICZNY},locationString:'Katowice, okolice Spodka',propertyType:PropertyType.INNY,valuationPurpose:ValuationPurpose.INNY,clientPrice:1300,additionalNotes:'Klient dzwonił w sprawie wyceny garażu podziemnego.',communicationLog:[{id:'logL9',date:new Date(Date.now()-86400000*2.5).toISOString(),author:'System',content:'Lead utworzony.'}],attachments:[],responses:[]}];

// ================================================================================= //
// BUNDLED FROM: services/geminiService.ts
// ================================================================================= //
const apiKey = process.env.API_KEY;
const ai = apiKey ? new GoogleGenAI({ apiKey }) : null;
const geocodeSchema = {type:Type.OBJECT,properties:{lat:{type:Type.NUMBER,description:"Szerokość geograficzna"},lng:{type:Type.NUMBER,description:"Długość geograficzna"},voivodeship:{type:Type.STRING,description:"Województwo w mianowniku, małymi literami, np. 'mazowieckie'"}},required:["lat","lng","voivodeship"]};
const geocodeAndGetVoivodeship = async(locationString)=>{if(!apiKey||!ai){console.error("API key for Gemini is not set.");return{coordinates:{lat:52.2297,lng:21.0122},voivodeship:'mazowieckie'}}const prompt=`Zwróć współrzędne geograficzne i województwo dla następującego adresu w Polsce: "${locationString}". Województwo podaj w mianowniku, małymi literami i z polskimi znakami diakrytycznymi, np. 'mazowieckie', 'małopolskie'. Odpowiedz TYLKO w formacie JSON, używając schematu, który został podany. Jeśli nie możesz znaleźć lokalizacji, zwróć JSON z wartościami null.`;try{const response=await ai.models.generateContent({model:"gemini-2.5-flash",contents:prompt,config:{responseMimeType:"application/json",responseSchema:geocodeSchema}});const jsonString=response.text;const result=JSON.parse(jsonString);if(result&&typeof result.lat==='number'&&typeof result.lng==='number'&&typeof result.voivodeship==='string'){return{coordinates:{lat:result.lat,lng:result.lng},voivodeship:result.voivodeship.toLowerCase()}}return null}catch(error){console.error("Error geocoding location:",error);return null}};
const verifyLandRegistry = async(kwNumber)=>{if(!apiKey||!ai){console.error("API key for Gemini is not set.");return`To jest przykładowa weryfikacja dla numeru KW: **${kwNumber}**.
    
### Dział I: Oznaczenie nieruchomości
- **Położenie:** ul. Przykładowa 1, 00-001 Warszawa, mazowieckie
- **Powierzchnia:** 0.0543 ha

### Dział II: Własność
- **Właściciel:** Jan Kowalski

### Dział III: Prawa, roszczenia i ograniczenia
- Brak wpisów.

### Dział IV: Hipoteka
- **Hipoteka umowna kaucyjna:** 250,000.00 PLN na rzecz Banku X.

*Uwaga: To są dane demonstracyjne. Dla rzeczywistej weryfikacji wymagany jest klucz API.*`}const prompt=`Jako asystent do weryfikacji numerów Ksiąg Wieczystych (KW) w Polsce, użyj narzędzia Google Search, aby znaleźć i podsumować publicznie dostępne informacje dla numeru KW: "${kwNumber}". Twoja odpowiedź powinna być zwięzłym raportem w języku polskim, sformatowanym przy użyciu Markdown. Skup się na kluczowych informacjach z działów I, II, III i IV. Jeśli numer jest nieprawidłowy lub nie można znaleźć danych, poinformuj o tym.`;try{const response=await ai.models.generateContent({model:"gemini-2.5-flash",contents:prompt,config:{tools:[{googleSearch:{}}]}});return response.text}catch(error){console.error(`Error verifying land registry for ${kwNumber}:`,error);return"Wystąpił błąd podczas weryfikacji numeru księgi wieczystej. Prosimy spróbować ponownie później."}};

// ================================================================================= //
// BUNDLED FROM: components/Modal.tsx
// ================================================================================= //
const Modal = ({isOpen,onClose,title,children,size='md',zIndex=1050})=>{if(!isOpen)return null;const sizeClasses={md:'max-w-lg',lg:'max-w-2xl',xl:'max-w-4xl','2xl':'max-w-5xl'};const modalWidthClass=sizeClasses[size]||sizeClasses.md;return React.createElement('div',{className:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center p-4",style:{zIndex}},React.createElement('div',{className:`bg-white rounded-lg shadow-xl w-full ${modalWidthClass} max-h-[90vh] flex flex-col`},React.createElement('div',{className:"p-4 border-b flex justify-between items-center sticky top-0 bg-white flex-shrink-0"},React.createElement('h2',{className:"text-xl font-semibold text-gray-800"},title),React.createElement('button',{onClick:onClose,className:"text-gray-500 hover:text-gray-800 text-2xl"},"×")),React.createElement('div',{className:"p-6 overflow-y-auto flex-grow"},children)))};

// ================================================================================= //
// BUNDLED FROM: components/NotificationProvider.tsx
// ================================================================================= //
const NotificationContext = createContext(undefined);
const useNotification = ()=>{const context=useContext(NotificationContext);if(!context)throw new Error('useNotification must be used within a NotificationProvider');return context};
const NotificationProvider = ({children})=>{const[notifications,setNotifications]=useState([]);const addNotification=(message,type)=>{const id=Date.now();setNotifications(prev=>[...prev,{id,message,type}]);setTimeout(()=>removeNotification(id),3000)};const removeNotification=id=>setNotifications(prev=>prev.filter(n=>n.id!==id));const notificationStyles={success:{bg:'bg-green-100',border:'border-green-400',text:'text-green-800',icon:React.createElement(CheckCircleIcon,{className:"w-6 h-6 text-green-500"})},error:{bg:'bg-red-100',border:'border-red-400',text:'text-red-800',icon:React.createElement('svg',{className:"w-6 h-6 text-red-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},React.createElement('path',{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"}))},info:{bg:'bg-indigo-100',border:'border-indigo-400',text:'text-indigo-800',icon:React.createElement('svg',{className:"w-6 h-6 text-indigo-500",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},React.createElement('path',{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}))}};return React.createElement(NotificationContext.Provider,{value:{addNotification}},children,React.createElement('div',{className:"notification-container"},notifications.map(notification=>{const styles=notificationStyles[notification.type];return React.createElement('div',{key:notification.id,className:`notification-item ${styles.bg} ${styles.border} ${styles.text}`},React.createElement('div',{className:"flex-shrink-0"},styles.icon),React.createElement('div',{className:"ml-3 flex-1"},React.createElement('p',{className:"text-sm font-medium"},notification.message)),React.createElement('div',{className:"ml-4 flex-shrink-0"},React.createElement('button',{onClick:()=>removeNotification(notification.id),className:"inline-flex rounded-md p-1.5 text-current hover:bg-black/10 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-current focus:ring-black"},React.createElement('span',{className:"sr-only"},"Dismiss"),React.createElement('svg',{className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor"},React.createElement('path',{d:"M6.28 5.22a.75.75 0 00-1.06 1.06L8.94 10l-3.72 3.72a.75.75 0 101.06 1.06L10 11.06l3.72 3.72a.75.75 0 101.06-1.06L11.06 10l3.72-3.72a.75.75 0 00-1.06-1.06L10 8.94 6.28 5.22z"})))))})))};

// ================================================================================= //
// BUNDLED FROM: components/Login.tsx
// ================================================================================= //
const Login = ({onLogin,error})=>{const[email,setEmail]=useState('');const[password,setPassword]=useState('');const handleSubmit=e=>{e.preventDefault();onLogin(email,password)};return React.createElement('div',{className:"flex items-center justify-center min-h-screen bg-gray-100"},React.createElement('div',{className:"w-full max-w-md p-8 space-y-6 bg-white rounded-lg shadow-md"},React.createElement('div',{className:"text-center"},React.createElement('h1',{className:"text-3xl font-bold text-gray-800"},"Giełda Zleceń Wyceny"),React.createElement('p',{className:"text-gray-500"},"Zaloguj się, aby kontynuować")),React.createElement('form',{className:"space-y-6",onSubmit:handleSubmit},React.createElement('div',null,React.createElement('label',{htmlFor:"email",className:"block text-sm font-medium text-gray-700"},"Adres email"),React.createElement('input',{id:"email",type:"email",required:true,value:email,onChange:e=>setEmail(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"admin@wyceny.pl"})),React.createElement('div',null,React.createElement('label',{htmlFor:"password",className:"block text-sm font-medium text-gray-700"},"Hasło"),React.createElement('input',{id:"password",type:"password",required:true,value:password,onChange:e=>setPassword(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"admin"})),error&&React.createElement('p',{className:"text-sm text-red-600"},error),React.createElement('button',{type:"submit",className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-indigo-600 hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500"},"Zaloguj się")),React.createElement('div',{className:"text-center text-sm text-gray-500"},React.createElement('p',null,"Admin: admin@wyceny.pl / admin"),React.createElement('p',null,"Rzeczoznawca: rzeczoznawca1@firma.pl / user"))))};

// ================================================================================= //
// BUNDLED FROM: components/ZlecenieCard.tsx (aliased from OrderCard.tsx)
// ================================================================================= //
const ZlecenieCard = ({zlecenie,onClick})=>{const currentStatusStyle=statusStyles[zlecenie.status]||{dot:'bg-gray-500',text:'text-gray-700',border:'border-gray-200',bg:'bg-gray-50'};return React.createElement('div',{onClick:()=>onClick(zlecenie),className:`p-3 border-l-4 rounded-md shadow-sm cursor-pointer transition-all duration-200 bg-white hover:shadow-md hover:bg-gray-50 ${currentStatusStyle.border}`},React.createElement('div',{className:"flex items-center justify-between space-x-2 mb-2"},React.createElement('p',{className:"text-xs font-semibold text-gray-800 truncate",title:zlecenie.locationString},zlecenie.locationString),React.createElement('span',{className:"text-xs font-bold text-gray-800 whitespace-nowrap"},zlecenie.proposedPrice||zlecenie.clientPrice," PLN")),React.createElement('div',{className:"flex items-center justify-end text-xs text-gray-500"},React.createElement('span',null,new Date(zlecenie.creationDate).toLocaleDateString())))}

// ================================================================================= //
// BUNDLED FROM: components/KanbanColumn.tsx (aliased from OrderList.tsx)
// ================================================================================= //
const KanbanColumn = ({title,zlecenia,onCardClick,status,onAddClick})=>{return React.createElement('div',{className:"flex-shrink-0 w-72 bg-gray-50 rounded-lg shadow-inner flex flex-col h-full"},React.createElement('div',{className:"p-3 border-b bg-white rounded-t-lg sticky top-0 z-10 flex justify-between items-center"},React.createElement('h3',{className:"text-sm font-semibold text-gray-700 uppercase"},title),React.createElement('span',{className:"px-2 py-0.5 text-xs font-bold text-gray-500 bg-gray-200 rounded-full"},zlecenia.length)),React.createElement('div',{className:"p-2 space-y-3 overflow-y-auto h-full"},status==='Lead'&&onAddClick&&React.createElement('button',{onClick:onAddClick,className:"w-full flex items-center justify-center p-3 border-2 border-dashed rounded-md text-gray-500 hover:bg-gray-100 hover:text-gray-700 hover:border-gray-400 transition-colors"},React.createElement(PlusCircleIcon,{className:"w-5 h-5 mr-2"}),React.createElement('span',{className:"text-sm font-medium"},"Dodaj Leada")),zlecenia.map(zlecenie=>React.createElement(ZlecenieCard,{key:zlecenie.id,zlecenie:zlecenie,onClick:onCardClick}))))};

// ================================================================================= //
// BUNDLED FROM: components/KanbanBoard.tsx (aliased from LeadsDashboard.tsx)
// ================================================================================= //
const KanbanBoard = ({zlecenia,onCardClick,onAddLeadClick})=>{const KANBAN_COLUMNS=[{title:'Nowe Leady',statuses:[ZlecenieStatus.LEAD]},{title:'Do Akceptacji',statuses:[ZlecenieStatus.DO_AKCEPTACJI]},{title:'Na Giełdzie',statuses:[ZlecenieStatus.NOWE,ZlecenieStatus.ZAREZERWOWANE]},{title:'W Trakcie',statuses:[ZlecenieStatus.W_TRAKCIE]},{title:'Do Rozliczenia',statuses:[ZlecenieStatus.DO_ROZLICZENIA]}];const getColumnZlecenia=statuses=>zlecenia.filter(z=>statuses.includes(z.status)).sort((a,b)=>new Date(b.creationDate).getTime()-new Date(a.creationDate).getTime());return React.createElement('div',{className:"h-full w-full flex flex-col bg-white rounded-lg shadow-sm"},React.createElement('div',{className:"flex-grow flex p-4 space-x-4 overflow-x-auto"},KANBAN_COLUMNS.map(col=>React.createElement(KanbanColumn,{key:col.title,title:col.title,zlecenia:getColumnZlecenia(col.statuses),onCardClick:onCardClick,status:col.statuses[0],onAddClick:col.statuses.includes(ZlecenieStatus.LEAD)?onAddLeadClick:undefined}))))};

// ================================================================================= //
// BUNDLED FROM: components/CommunicationLog.tsx
// ================================================================================= //
const CommunicationLog = ({log,onAddEntry})=>{const[newEntry,setNewEntry]=useState('');const sortedLog=[...log].sort((a,b)=>new Date(b.date).getTime()-new Date(a.date).getTime());const handleAddEntry=()=>{if(newEntry.trim()&&onAddEntry){onAddEntry(newEntry.trim());setNewEntry('')}};return React.createElement('div',{className:"pt-4 animate-fade-in"},onAddEntry&&React.createElement('div',{className:"mb-3"},React.createElement('label',{htmlFor:"communication-entry",className:"block text-sm font-medium text-gray-700"},"Dodaj wpis do historii"),React.createElement('div',{className:"mt-1 flex rounded-md shadow-sm"},React.createElement('textarea',{id:"communication-entry",rows:2,value:newEntry,onChange:e=>setNewEntry(e.target.value),className:"flex-1 block w-full min-w-0 rounded-none rounded-l-md border-gray-300 focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Wpisz treść notatki..."}),React.createElement('button',{type:"button",onClick:handleAddEntry,className:"inline-flex items-center px-3 py-2 border border-l-0 border-gray-300 bg-gray-50 text-sm font-medium text-gray-700 hover:bg-gray-100 rounded-r-md"},"Dodaj"))),React.createElement('div',{className:"space-y-3 max-h-64 overflow-y-auto bg-gray-50 p-3 rounded-md border"},sortedLog.length>0?sortedLog.map(entry=>React.createElement('div',{key:entry.id,className:"text-sm pb-2 mb-2 border-b last:border-b-0"},React.createElement('p',{className:"font-semibold text-gray-700"},entry.author,React.createElement('span',{className:"ml-2 font-normal text-gray-500 text-xs"},new Date(entry.date).toLocaleString('pl-PL'))),React.createElement('p',{className:"text-gray-600 whitespace-pre-wrap"},entry.content))):React.createElement('p',{className:"text-sm text-gray-500 text-center py-2"},"Brak wpisów w historii.")))};

// ================================================================================= //
// BUNDLED FROM: components/ZlecenieDetails.tsx (aliased from OrderDetails.tsx)
// ================================================================================= //
const ZlecenieDetails = ({zlecenie,currentUser,users,onEdit,onSubmitOperat,onAddCommunicationEntry,onAttachFile,onDeleteFile,onUpdateStatus,onUpdateSubStatus,onUpdateSettlementChecklist,onFinalize,activeSubcontractorTab})=>{const fileInputRef=useRef(null);const[isHistoryModalOpen,setIsHistoryModalOpen]=useState(false);const[editedZlecenie,setEditedZlecenie]=useState(zlecenie);const[isDirty,setIsDirty]=useState(false);useEffect(()=>{setEditedZlecenie(zlecenie);setIsDirty(false)},[zlecenie]);const assignedUser=editedZlecenie.assignedAppraiserId?users.find(u=>u.id===editedZlecenie.assignedAppraiserId):null;const isInternalUser=currentUser?.role===UserRole.ADMIN||currentUser?.role===UserRole.PRACOWNIK;const isAppraiser=currentUser?.role===UserRole.RZECZOZNAWCA;const isAssignedAppraiser=editedZlecenie.assignedAppraiserId===currentUser?.id;const showFullDetails=isInternalUser||isAssignedAppraiser&&editedZlecenie.status!==ZlecenieStatus.NOWE;const handleFileSelect=e=>{if(e.target.files&&e.target.files[0]){onAttachFile(editedZlecenie.id,e.target.files[0])}e.target.value=''};const handleCancel=()=>{setEditedZlecenie(zlecenie);setIsDirty(false)};const handleSave=()=>{if(!isDirty)return;if(zlecenie.status!==editedZlecenie.status){onUpdateStatus(zlecenie.id,editedZlecenie.status)}if(zlecenie.subStatus!==editedZlecenie.subStatus&&editedZlecenie.subStatus){onUpdateSubStatus(zlecenie.id,editedZlecenie.subStatus)}const originalChecklist=zlecenie.settlementChecklist;const editedChecklist=editedZlecenie.settlementChecklist;if(editedChecklist&&JSON.stringify(originalChecklist)!==JSON.stringify(editedChecklist)){Object.keys(editedChecklist).forEach(key=>{if(!originalChecklist||originalChecklist[key]!==editedChecklist[key]){onUpdateSettlementChecklist(zlecenie.id,key,editedChecklist[key])}})}setIsDirty(false)};const isChecklistComplete=useMemo(()=>{if(!editedZlecenie.settlementChecklist)return false;return Object.values(editedZlecenie.settlementChecklist).every(Boolean)},[editedZlecenie.settlementChecklist]);const currentStatusStyle=statusStyles[editedZlecenie.status]||{dot:'bg-gray-500',text:'text-gray-700'};const operatFile=editedZlecenie.attachments.find(file=>file.id.startsWith('file-operat-'));const DetailSection=({title,children,className})=>React.createElement('div',{className:`pt-4 mt-4 border-t ${className||''}`},React.createElement('h4',{className:"text-base font-semibold text-gray-800 mb-3"},title),React.createElement('div',{className:"bg-gray-50/75 border border-gray-200 rounded-lg p-3"},children));const DetailItem=({label,value,children})=>React.createElement('div',null,value!==undefined&&React.createElement('p',{className:"text-base font-semibold text-gray-900 min-h-[24px]"},value||'Brak'),children,React.createElement('p',{className:"text-xs text-gray-500 uppercase tracking-wider mt-1"},label));return React.createElement('div',{className:"h-full flex flex-col"},React.createElement('div',{className:"flex-grow overflow-y-auto p-4"},React.createElement('div',{className:"space-y-3"},React.createElement('div',{className:"pb-4 border-b"},React.createElement('div',{className:"flex items-start justify-between gap-4"},React.createElement('div',{className:"min-w-0"},React.createElement('div',{className:"flex items-center space-x-1"},React.createElement(MapPinIcon,{className:"w-6 h-6 text-indigo-600 flex-shrink-0"}),React.createElement('h2',{className:"text-xl font-bold text-gray-900 break-words"},showFullDetails?editedZlecenie.locationString:`Zlecenie w: ${editedZlecenie.locationString.split(',').pop()?.trim()||editedZlecenie.locationString}`)),React.createElement('div',{className:"mt-1 pl-7 flex items-center gap-x-4 text-sm text-gray-500"},React.createElement('span',null,"ID: #",editedZlecenie.id),React.createElement('span',null,"Dodano: ",new Date(editedZlecenie.creationDate).toLocaleDateString('pl-PL')),editedZlecenie.clientPrice&&editedZlecenie.proposedPrice&&React.createElement('div',{className:"flex items-center gap-1"},React.createElement('span',{className:"font-bold text-lg text-green-700"},(editedZlecenie.clientPrice-editedZlecenie.proposedPrice).toFixed(2)," PLN"),React.createElement('span',{className:"text-xs text-green-600 uppercase tracking-wider"},"Marża")))),React.createElement('div',{className:"flex-shrink-0 ml-4 space-y-2 text-right"},isAppraiser&&isAssignedAppraiser&&editedZlecenie.status===ZlecenieStatus.W_TRAKCIE&&React.createElement('button',{onClick:()=>onSubmitOperat(editedZlecenie),className:"w-full flex items-center justify-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 text-sm font-medium"},React.createElement(CheckCircleIcon,{className:"w-5 h-5"}),React.createElement('span',null,"Zakończ i przekaż operat")),React.createElement('div',{className:"flex items-center justify-end space-x-2"},React.createElement('div',{className:`w-3 h-3 rounded-full ${currentStatusStyle.dot}`}),isInternalUser?React.createElement('select',{value:editedZlecenie.status,onChange:e=>{setIsDirty(true);setEditedZlecenie(prev=>({...prev,status:e.target.value as ZlecenieStatus}))},className:`block w-full max-w-xs pl-3 pr-10 py-1.5 text-sm font-semibold bg-white text-gray-900 border border-gray-300 shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 rounded-md`},ZLECENIE_STATUSES.map(s=>React.createElement('option',{key:s,value:s},s))):React.createElement('span',{className:`text-sm font-semibold uppercase ${currentStatusStyle.text}`},editedZlecenie.status),React.createElement('button',{onClick:()=>setIsHistoryModalOpen(true),className:"p-1.5 text-gray-500 rounded-full hover:bg-gray-100 hover:text-gray-800",title:"Pokaż historię"},React.createElement(ClockIcon,{className:"w-4 h-4"})),isInternalUser&&React.createElement('button',{onClick:()=>onEdit(editedZlecenie),className:"p-1.5 text-gray-500 rounded-full hover:bg-gray-100 hover:text-gray-800",title:"Edytuj zlecenie"},React.createElement(PencilIcon,{className:"w-4 h-4"})))))),assignedUser&&React.createElement('div',{className:"p-3 bg-indigo-50 border border-indigo-200 rounded-lg"},React.createElement('h4',{className:"text-sm font-semibold text-indigo-800 mb-2"},"Przypisany Rzeczoznawca"),React.createElement('div',{className:"flex items-center space-x-4"},React.createElement('div',{className:"flex-shrink-0"},React.createElement('span',{className:"inline-block h-8 w-8 rounded-full overflow-hidden bg-indigo-100"},React.createElement('svg',{className:"h-full w-full text-indigo-300",fill:"currentColor",viewBox:"0 0 24 24"},React.createElement('path',{d:"M24 20.993V24H0v-2.996A14.977 14.977 0 0112.004 15c4.904 0 9.26 2.354 11.996 5.993zM16.002 8.999a4 4 0 11-8 0 4 4 0 018 0z"})))),React.createElement('div',null,React.createElement('p',{className:"text-sm font-medium text-gray-900"},`${assignedUser.firstName} ${assignedUser.lastName}`),React.createElement('p',{className:"text-sm text-gray-500"},assignedUser.email)))),editedZlecenie.status===ZlecenieStatus.W_TRAKCIE&&editedZlecenie.subStatus&&React.createElement('div',{className:"p-3 bg-purple-50 border border-purple-200 rounded-lg"},React.createElement('div',{className:"text-sm font-semibold text-purple-800"},"Postęp prac: ",React.createElement('span',{className:"font-bold"},editedZlecenie.subStatus)),isAssignedAppraiser&&React.createElement('div',{className:"mt-2 pt-2 border-t border-purple-200/50 flex items-center gap-2"},React.createElement('label',{className:"text-xs font-medium text-purple-700"},"Zmień postęp:"),React.createElement('select',{value:editedZlecenie.subStatus,onChange:e=>{setIsDirty(true);setEditedZlecenie(prev=>({...prev,subStatus:e.target.value as WorkInProgressSubStatus}))},className:"block w-full max-w-xs pl-2 pr-8 py-1 text-xs border-purple-300 focus:outline-none focus:ring-purple-500 focus:border-purple-500 rounded-md"},WORK_IN_PROGRESS_SUBSTATUSES.map(s=>React.createElement('option',{key:s,value:s},s))))),editedZlecenie.status===ZlecenieStatus.DO_ROZLICZENIA&&isInternalUser&&editedZlecenie.settlementChecklist&&React.createElement(DetailSection,{title:"Checklista zamknięcia zlecenia"},React.createElement('div',{className:"p-4 bg-cyan-50 border border-cyan-200 rounded-lg space-y-3"},Object.entries(editedZlecenie.settlementChecklist).map(([key,value])=>{const labels={operatPobrany:'Pobrano operat',fakturaWystawiona:'Wystawiono fakturę dla klienta',fakturaOplacona:'Faktura opłacona przez klienta',operatPrzekazany:'Przekazano operat klientowi',rozliczonoZRzeczoznawca:'Rozliczono z rzeczoznawcą'};return React.createElement('label',{key:key,className:"flex items-center space-x-3"},React.createElement('input',{type:"checkbox",checked:value,onChange:e=>{setIsDirty(true);setEditedZlecenie(prev=>{const updatedChecklist={...prev.settlementChecklist,[key]:e.target.checked};return{...prev,settlementChecklist:updatedChecklist}})},className:"h-5 w-5 rounded border-gray-300 text-indigo-600 focus:ring-indigo-500"}),React.createElement('span',{className:`text-sm ${value?'text-gray-800 line-through':'text-gray-800'}`},labels[key],key==='operatPobrany'&&operatFile&&React.createElement('a',{href:operatFile.url,download:operatFile.name,className:"ml-2 text-indigo-600 hover:underline text-xs"},"(pobierz)")))}),React.createElement('div',{className:"mt-4"},React.createElement('button',{onClick:()=>onFinalize(editedZlecenie.id),disabled:!isChecklistComplete,className:"w-full flex items-center justify-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-green-300 text-sm font-medium"},React.createElement(CheckCircleIcon,{className:"w-5 h-5"}),React.createElement('span',null,"Zakończ i zarchiwizuj")))),showFullDetails?React.createElement(React.Fragment,null,React.createElement(DetailSection,{title:"Dane Nieruchomości"},React.createElement('div',{className:"grid grid-cols-2 lg:grid-cols-4 gap-x-6 gap-y-4"},React.createElement(DetailItem,{label:"Rodzaj",value:editedZlecenie.propertyType, children: null}),React.createElement(DetailItem,{label:"Cel",value:editedZlecenie.valuationPurpose, children: null}),React.createElement(DetailItem,{label:"Numer KW",value:editedZlecenie.kwNumber, children: null}),React.createElement(DetailItem,{label:"Województwo",value:editedZlecenie.voivodeship, children: null}))),editedZlecenie.clientDetails&&React.createElement(DetailSection,{title:"Dane Klienta"},React.createElement('div',{className:"grid grid-cols-1 lg:grid-cols-3 gap-x-6 gap-y-4"},React.createElement(DetailItem,{label:"Imię i Nazwisko",value:editedZlecenie.clientDetails.fullName, children: null}),React.createElement(DetailItem,{label:"Telefon",value:editedZlecenie.clientDetails.phone, children: null}),React.createElement(DetailItem,{label:"Email",value:editedZlecenie.clientDetails.email, children: null}))),React.createElement(DetailSection,{title:"Warunki zlecenia"},React.createElement('div',{className:"grid grid-cols-2 lg:grid-cols-3 gap-x-6 gap-y-4"},React.createElement(DetailItem,{label:"Cena dla klienta",value:editedZlecenie.clientPrice?`${editedZlecenie.clientPrice} PLN`:'Brak danych', children: null}),React.createElement(DetailItem,{label:"Cena dla rzeczoznawcy",value:`${editedZlecenie.proposedPrice} PLN`, children: null}),React.createElement(DetailItem,{label:"Proponowany termin",value:editedZlecenie.proposedCompletionDate?new Date(editedZlecenie.proposedCompletionDate).toLocaleDateString('pl-PL'):'Brak', children: null}),React.createElement(DetailItem,{label:"Data zakończenia",value:editedZlecenie.actualCompletionDate?new Date(editedZlecenie.actualCompletionDate).toLocaleDateString('pl-PL'):'Brak', children: null}),React.createElement(DetailItem,{label:"Forma operatu",value:editedZlecenie.clientDetails.appraisalForm, children: null}))),editedZlecenie.additionalNotes&&React.createElement(DetailSection,{title:"Dodatkowe uwagi"},React.createElement('p',{className:"text-sm text-gray-700 whitespace-pre-wrap bg-gray-50 p-3 rounded-md border"},editedZlecenie.additionalNotes)),React.createElement(DetailSection,{title:"Załączniki"},React.createElement('div',{className:"space-y-3"},React.createElement('button',{onClick:()=>fileInputRef.current?.click(),className:"w-full max-w-xs px-3 py-1.5 bg-indigo-100 text-indigo-700 rounded-md hover:bg-indigo-200 text-xs font-medium"},"+ Dodaj plik"),React.createElement('input',{type:"file",ref:fileInputRef,onChange:handleFileSelect,className:"hidden"}),React.createElement('div',{className:"space-y-2 pt-2"},editedZlecenie.attachments.length>0?editedZlecenie.attachments.map(file=>React.createElement('div',{key:file.id,className:"flex justify-between items-center p-2 bg-gray-50 rounded-md border"},React.createElement('div',null,React.createElement('a',{href:file.url,download:file.name,className:"font-medium text-indigo-600 hover:underline"},file.name),React.createElement('p',{className:"text-xs text-gray-500"},(file.size/1024).toFixed(1)," KB - ",new Date(file.uploadedAt).toLocaleDateString())),React.createElement('button',{onClick:()=>onDeleteFile(editedZlecenie.id,file.id),className:"p-1.5 text-gray-400 hover:text-red-600 rounded-full hover:bg-red-50",title:"Usuń plik"},React.createElement(TrashIcon,{className:"w-4 h-4"})))):React.createElement('p',{className:"text-sm text-gray-500 text-center py-2"},"Brak załączników."))))):React.createElement('div',{className:"mt-4 pt-4 border-t text-center bg-gray-50 p-4 rounded-lg"},React.createElement('h4',{className:"font-semibold text-gray-800"},"Szczegóły zlecenia są ukryte"),React.createElement('p',{className:"text-sm text-gray-600 mt-1"},"Pełne dane, w tym dokładny adres i uwagi, będą widoczne po zaakceptowaniu zlecenia i zmianie jego statusu na \"W trakcie\".")))),isInternalUser&&isDirty&&React.createElement('div',{className:"flex-shrink-0 p-4 border-t bg-gray-50 flex justify-end space-x-3"},React.createElement('button',{type:"button",onClick:handleCancel,className:"px-4 py-2 bg-white border border-gray-300 text-gray-800 rounded-md hover:bg-gray-100 font-medium"},"Anuluj"),React.createElement('button',{type:"button",onClick:handleSave,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 font-medium"},"Zapisz zmiany")),React.createElement(Modal,{isOpen:isHistoryModalOpen,onClose:()=>setIsHistoryModalOpen(false),title:`Historia zlecenia #${editedZlecenie.id}`,size:"lg"},React.createElement(CommunicationLog,{log:editedZlecenie.communicationLog, onAddEntry:undefined})))};

// ================================================================================= //
// BUNDLED FROM: components/ZlecenieForm.tsx (aliased from LeadForm.tsx)
// ================================================================================= //
const ZlecenieForm = ({onSubmit,onClose,propertyTypes,valuationPurposes,appraisalForms,initialData})=>{const getInitialFormData=()=>{if(initialData)return initialData;return{status:ZlecenieStatus.LEAD,propertyType:propertyTypes[0],valuationPurpose:valuationPurposes[0],clientDetails:{fullName:'',appraisalForm:appraisalForms[0],phone:''},source:LeadSource.TELEFON}};const[formData,setFormData]=useState(getInitialFormData());const[isLoading,setIsLoading]=useState(false);const isEditing=!!initialData;const isLead=formData.status===ZlecenieStatus.LEAD;useEffect(()=>{setFormData(getInitialFormData())},[initialData]);const handleChange=e=>{const{name,value}=e.target;if(['fullName','phone','email','appraisalForm'].includes(name)){setFormData(prev=>({...prev,clientDetails:{...prev.clientDetails,[name]:value}}))}else{setFormData(prev=>({...prev,[name]:value}))}};const handleConvertToOrder=()=>{if(!formData.proposedPrice||Number(formData.proposedPrice)<=0){alert('Cena dla rzeczoznawcy jest wymagana do konwersji na zlecenie.');return}setFormData(prev=>({...prev,status:ZlecenieStatus.NOWE,publicationDate:new Date().toISOString()}))};const handleSubmit=async e=>{e.preventDefault();setIsLoading(true);if(!formData.locationString||!formData.clientDetails?.phone||!formData.clientDetails?.fullName){alert('Lokalizacja, imię, nazwisko oraz telefon klienta są wymagane.');setIsLoading(false);return}let geocodeResult={coordinates:formData.coordinates,voivodeship:formData.voivodeship};if(!isEditing||formData.locationString!==initialData?.locationString){const result=await geocodeAndGetVoivodeship(formData.locationString);if(result){geocodeResult={coordinates:result.coordinates,voivodeship:result.voivodeship}}else{alert('Nie udało się znaleźć lokalizacji. Sprawdź adres.');setIsLoading(false);return}}const finalData={...formData,clientPrice:formData.clientPrice?Number(formData.clientPrice):undefined,proposedPrice:formData.proposedPrice?Number(formData.proposedPrice):undefined,...geocodeResult};onSubmit(finalData,initialData?.id);setIsLoading(false)};const inputStyles="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm";const selectStyles="mt-1 block w-full pl-3 pr-10 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm";const FormSection=({title,children})=>React.createElement('div',{className:"pt-3"},React.createElement('h3',{className:"text-md font-semibold text-gray-800 border-b pb-2 mb-3"},title),React.createElement('div',{className:"space-y-3"},children));return React.createElement('form',{onSubmit:handleSubmit,className:"space-y-2"},React.createElement(FormSection,{title:"Dane Nieruchomości"},React.createElement('div',{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},React.createElement('div',null,React.createElement('label',{className:"block text-sm font-medium text-gray-700"},"Lokalizacja *"),React.createElement('input',{type:"text",name:"locationString",value:formData.locationString||'',onChange:handleChange,className:inputStyles,required:true})),React.createElement('div',null,React.createElement('label',{className:"block text-sm font-medium text-gray-700"},"Numer KW"),React.createElement('input',{type:"text",name:"kwNumber",value:formData.kwNumber||'',onChange:handleChange,className:inputStyles}))),React.createElement('div',{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},React.createElement('div',null,React.createElement('label',{className:"block text-sm font-medium text-gray-700"},"Rodzaj nieruchomości *"),React.createElement('select',{name:"propertyType",value:formData.propertyType,onChange:handleChange,className:selectStyles},propertyTypes.map(type=>React.createElement('option',{key:type,value:type},type)))),React.createElement('div',null,React.createElement('label',{className:"block text-sm font-medium text-gray-700"},"Cel wyceny *"),React.createElement('select',{name:"valuationPurpose",value:formData.valuationPurpose,onChange:handleChange,className:selectStyles},valuationPurposes.map(purpose=>React.createElement('option',{key:purpose,value:purpose},purpose)))))),React.createElement(FormSection,{title:"Dane Klienta"},React.createElement('div',{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},React.createElement('div',null,React.createElement('label',{className:"block text-sm font-medium text-gray-700"},"Imię i nazwisko klienta *"),React.createElement('input',{type:"text",name:"fullName",value:formData.clientDetails?.fullName||'',onChange:handleChange,className:inputStyles,required:true})),React.createElement('div',null,React.createElement('label',{className:"block text-sm font-medium text-gray-700"},"Telefon klienta *"),React.createElement('input',{type:"tel",name:"phone",value:formData.clientDetails?.phone||'',onChange:handleChange,className:inputStyles,required:true})),React.createElement('div',null,React.createElement('label',{className:"block text-sm font-medium text-gray-700"},"Email"),React.createElement('input',{type:"email",name:"email",value:formData.clientDetails?.email||'',onChange:handleChange,className:inputStyles})),React.createElement('div',null,React.createElement('label',{className:"block text-sm font-medium text-gray-700"},"Źródło pozyskania *"),React.createElement('select',{name:"source",value:formData.source,onChange:handleChange,className:selectStyles,required:true},Object.values(LeadSource).map(source=>React.createElement('option',{key:source,value:source},source)))))),React.createElement(FormSection,{title:"Warunki Zlecenia"},React.createElement('div',{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},React.createElement('div',null,React.createElement('label',{className:"block text-sm font-medium text-gray-700"},"Cena dla klienta (PLN)"),React.createElement('input',{type:"number",name:"clientPrice",value:formData.clientPrice||'',onChange:handleChange,className:inputStyles})),React.createElement('div',null,React.createElement('label',{className:"block text-sm font-medium text-gray-700"},"Cena dla rzeczoznawcy (PLN)"),React.createElement('input',{type:"number",name:"proposedPrice",value:formData.proposedPrice||'',onChange:handleChange,className:inputStyles}))),React.createElement('div',{className:"grid grid-cols-1 md:grid-cols-2 gap-4"},React.createElement('div',null,React.createElement('label',{className:"block text-sm font-medium text-gray-700"},"Proponowany termin"),React.createElement('input',{type:"date",name:"proposedCompletionDate",value:formData.proposedCompletionDate||'',onChange:handleChange,className:inputStyles})),React.createElement('div',null,React.createElement('label',{className:"block text-sm font-medium text-gray-700"},"Forma operatu *"),React.createElement('select',{name:"appraisalForm",value:formData.clientDetails?.appraisalForm,onChange:handleChange,className:selectStyles,required:true},appraisalForms.map(form=>React.createElement('option',{key:form,value:form},form)))))),React.createElement(FormSection,{title:"Dodatkowe Informacje"},React.createElement('div',null,React.createElement('label',{className:"block text-sm font-medium text-gray-700"},"Dodatkowe uwagi"),React.createElement('textarea',{name:"additionalNotes",rows:2,maxLength:160,value:formData.additionalNotes||'',onChange:handleChange,className:inputStyles}))),React.createElement('div',{className:"flex justify-between items-center pt-4 space-x-2 border-t"},React.createElement('div',null,isEditing&&isLead&&React.createElement('button',{type:"button",onClick:handleConvertToOrder,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:bg-green-300"},"Konwertuj na Zlecenie")),React.createElement('div',{className:"flex space-x-2"},React.createElement('button',{type:"button",onClick:onClose,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300"},"Anuluj"),React.createElement('button',{type:"submit",disabled:isLoading,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-indigo-300"},isLoading?'Zapisywanie...':'Zapisz'))))};

// ================================================================================= //
// BUNDLED FROM: components/OrderMap.tsx
// ================================================================================= //
const createIcon = color => new L.Icon({iconUrl:`data:image/svg+xml;charset=UTF-8,${encodeURIComponent(`<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="${color}" width="36" height="36"><path d="M12 2C8.13 2 5 5.13 5 9c0 5.25 7 13 7 13s7-7.75 7-13c0-3.87-3.13-7-7-7zm0 9.5c-1.38 0-2.5-1.12-2.5-2.5s1.12-2.5 2.5-2.5 2.5 1.12 2.5 2.5-1.12 2.5-2.5 2.5z"/></svg>`)}`,iconSize:[36,36],iconAnchor:[18,36],popupAnchor:[0,-36],shadowUrl:'https://unpkg.com/leaflet@1.9.4/dist/images/marker-shadow.png',shadowSize:[41,41],shadowAnchor:[12,41]});
const defaultIcon = createIcon('#6366f1');
const selectedIcon = createIcon('#4338ca');
const OrderMap = ({zlecenia,selectedZlecenie,currentUser})=>{const mapRef=useRef(null);const polandCenter=[52.237049,21.017532];const{mapCenter,mapZoom,voivodeshipGeoJson}=useMemo(()=>{if(currentUser?.role===UserRole.RZECZOZNAWCA&&currentUser.assignedVoivodeships?.[0]){const voivodeshipName=currentUser.assignedVoivodeships[0];const data=VOIVODESHIP_DATA[voivodeshipName];if(data){return{mapCenter:data.center,mapZoom:data.zoom,voivodeshipGeoJson:data.geoJson}}}return{mapCenter:polandCenter,mapZoom:6,voivodeshipGeoJson:null}},[currentUser]);useEffect(()=>{if(mapRef.current&&selectedZlecenie&&selectedZlecenie.coordinates){const{lat,lng}=selectedZlecenie.coordinates;mapRef.current.flyTo([lat,lng],12)}},[selectedZlecenie]);useEffect(()=>{const timer=setTimeout(()=>{if(mapRef.current){mapRef.current.invalidateSize()}},100);return()=>clearTimeout(timer)},[]);return React.createElement('div',{className:"h-full w-full rounded-lg shadow-md overflow-hidden"},React.createElement('div',{className:"h-full"},React.createElement(MapContainer,{center:mapCenter,zoom:mapZoom,scrollWheelZoom:true,ref:mapRef,key:currentUser?.id},React.createElement(TileLayer,{attribution:'&copy; <a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> contributors',url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png"}),voivodeshipGeoJson&&React.createElement(GeoJSON,{data:voivodeshipGeoJson,style:{color:'#6366f1',weight:2,opacity:.6,fillColor:'#c7d2fe',fillOpacity:.2}}),zlecenia.map(zlecenie=>{if(!zlecenie.coordinates)return null;const isSelected=selectedZlecenie?.id===zlecenie.id;return React.createElement(Marker,{key:zlecenie.id,position:[zlecenie.coordinates.lat,zlecenie.coordinates.lng],icon:isSelected?selectedIcon:defaultIcon},React.createElement(Popup,null,React.createElement('div',{className:"text-sm"},React.createElement('p',{className:"font-bold"},zlecenie.locationString),React.createElement('p',null,zlecenie.propertyType),React.createElement('p',null,"Cena: ",zlecenie.proposedPrice," PLN"))))})))))};

// ================================================================================= //
// BUNDLED FROM: components/AppraiserResponseForm.tsx
// ================================================================================= //
const AppraiserResponseForm = ({zlecenie,onSubmit,onClose})=>{const[responseType,setResponseType]=useState('accept');const[counterPrice,setCounterPrice]=useState('');const[completionDate,setCompletionDate]=useState('');const[questions,setQuestions]=useState('');const handleSubmit=e=>{e.preventDefault();if(!completionDate){alert('Proszę podać termin wykonania.');return}if(responseType==='counter'&&!counterPrice){alert('Proszę podać proponowaną cenę.');return}onSubmit({status:responseType==='accept'?'accepted':'counter-offer',proposedPrice:responseType==='counter'?Number(counterPrice):undefined,completionDate,questions})};return React.createElement('form',{onSubmit:handleSubmit,className:"space-y-4"},React.createElement('div',null,React.createElement('p',{className:"text-gray-700"},React.createElement('span',{className:"font-semibold"},"Lokalizacja:")," ",zlecenie.locationString),React.createElement('p',{className:"text-gray-700"},React.createElement('span',{className:"font-semibold"},"Sugerowana cena:")," ",zlecenie.proposedPrice," PLN")),React.createElement('fieldset',{className:"space-y-2"},React.createElement('legend',{className:"text-sm font-medium text-gray-900"},"Twoja odpowiedź"),React.createElement('div',{className:"flex items-center"},React.createElement('input',{id:"accept",name:"response-type",type:"radio",value:"accept",checked:responseType==='accept',onChange:()=>setResponseType('accept'),className:"h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),React.createElement('label',{htmlFor:"accept",className:"ml-3 block text-sm font-medium text-gray-700"},"Akceptuję cenę (",zlecenie.proposedPrice," PLN)")),React.createElement('div',{className:"flex items-center"},React.createElement('input',{id:"counter",name:"response-type",type:"radio",value:"counter",checked:responseType==='counter',onChange:()=>setResponseType('counter'),className:"h-4 w-4 text-indigo-600 border-gray-300 focus:ring-indigo-500"}),React.createElement('label',{htmlFor:"counter",className:"ml-3 block text-sm font-medium text-gray-700"},"Proponuję swoją cenę"))),responseType==='counter'&&React.createElement('div',null,React.createElement('label',{htmlFor:"counterPrice",className:"block text-sm font-medium text-gray-700"},"Twoja propozycja ceny (PLN) *"),React.createElement('input',{type:"number",id:"counterPrice",value:counterPrice,onChange:e=>setCounterPrice(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",required:true})),React.createElement('div',null,React.createElement('label',{htmlFor:"completionDate",className:"block text-sm font-medium text-gray-700"},"Termin wykonania *"),React.createElement('input',{type:"date",id:"completionDate",value:completionDate,onChange:e=>setCompletionDate(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",required:true})),React.createElement('div',null,React.createElement('label',{htmlFor:"questions",className:"block text-sm font-medium text-gray-700"},"Dodatkowe pytania / uwagi"),React.createElement('textarea',{id:"questions",rows:3,value:questions,onChange:e=>setQuestions(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Wpisz tutaj swoje pytania..."})),React.createElement('div',{className:"flex justify-end pt-4 space-x-2"},React.createElement('button',{type:"button",onClick:onClose,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300"},"Anuluj"),React.createElement('button',{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700"},"Wyślij odpowiedź")))};

// ================================================================================= //
// BUNDLED FROM: components/FilterControls.tsx
// ================================================================================= //
const FilterControls = ({filters,onFilterChange,propertyTypes,valuationPurposes,statuses,currentUser,users})=>{const[isExpanded,setIsExpanded]=useState(false);const handleMultiSelectChange=(name,value)=>{if(value==='all'){onFilterChange(name,[]);return}const currentValues=filters[name]||[];const newValues=currentValues.includes(value)?currentValues.filter(v=>v!==value):[...currentValues,value];onFilterChange(name,newValues)};if(currentUser?.role===UserRole.ADMIN||currentUser?.role===UserRole.PRACOWNIK){const appraisers=users.filter(u=>u.role===UserRole.RZECZOZNAWCA);return React.createElement('div',{className:"bg-white p-4 rounded-lg shadow-sm mb-4 animate-fade-in"},React.createElement('div',{className:`flex justify-between items-center gap-4 ${isExpanded?'mb-4':''}`},React.createElement('div',{className:"flex-grow min-w-0"},React.createElement('input',{type:"text",value:filters.quickSearch,onChange:e=>onFilterChange('quickSearch',e.target.value),placeholder:"Szukaj po ID, adresie...",className:"block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm placeholder-gray-400 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm"})),React.createElement('button',{onClick:()=>setIsExpanded(!isExpanded),className:"flex items-center space-x-1 px-3 py-1.5 text-sm font-medium text-indigo-600 rounded-md hover:bg-indigo-50 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-indigo-500 flex-shrink-0",'aria-expanded':isExpanded},React.createElement('span',null,isExpanded?'Zwiń':'Filtry'),React.createElement('svg',{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transition-transform duration-200 ${isExpanded?'rotate-180':''}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},React.createElement('path',{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})))),isExpanded&&React.createElement('div',{className:"pt-4 border-t space-y-4"},React.createElement('div',{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4"},React.createElement('div',null,React.createElement('label',{htmlFor:"assignedAppraiserId",className:"block text-sm font-medium text-gray-700"},"Rzeczoznawca"),React.createElement('select',{id:"assignedAppraiserId",name:"assignedAppraiserId",value:filters.assignedAppraiserId,onChange:e=>onFilterChange('assignedAppraiserId',e.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"},React.createElement('option',{value:"all"},"Wszyscy"),appraisers.map(user=>React.createElement('option',{key:user.id,value:user.id},user.email)))),React.createElement('div',null,React.createElement('label',{htmlFor:"voivodeship",className:"block text-sm font-medium text-gray-700"},"Województwo"),React.createElement('select',{id:"voivodeship",name:"voivodeship",value:filters.voivodeship,onChange:e=>onFilterChange('voivodeship',e.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"},React.createElement('option',{value:"all"},"Wszystkie"),Object.keys(VOIVODESHIP_DATA).map(v=>React.createElement('option',{key:v,value:v},v.charAt(0).toUpperCase()+v.slice(1))))),React.createElement('div',null,React.createElement('label',{htmlFor:"propertyType",className:"block text-sm font-medium text-gray-700"},"Rodzaj nieruchomości"),React.createElement('select',{id:"propertyType",name:"propertyType",value:filters.propertyType[0]||'all',onChange:e=>onFilterChange('propertyType',e.target.value==='all'?[]:[e.target.value]),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"},React.createElement('option',{value:"all"},"Wszystkie"),propertyTypes.map(type=>React.createElement('option',{key:type,value:type},type)))),React.createElement('div',null,React.createElement('label',{htmlFor:"valuationPurpose",className:"block text-sm font-medium text-gray-700"},"Cel wyceny"),React.createElement('select',{id:"valuationPurpose",name:"valuationPurpose",value:filters.valuationPurpose[0]||'all',onChange:e=>onFilterChange('valuationPurpose',e.target.value==='all'?[]:[e.target.value]),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"},React.createElement('option',{value:"all"},"Wszystkie"),valuationPurposes.map(purpose=>React.createElement('option',{key:purpose,value:purpose},purpose)))),React.createElement('div',null,React.createElement('label',{htmlFor:"status",className:"block text-sm font-medium text-gray-700"},"Status zlecenia"),React.createElement('select',{id:"status",name:"status",value:filters.status[0]||'all',onChange:e=>onFilterChange('status',e.target.value==='all'?[]:[e.target.value]),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"},React.createElement('option',{value:"all"},"Wszystkie"),statuses.map(status=>React.createElement('option',{key:status,value:status},status)))),React.createElement('div',null,React.createElement('label',{htmlFor:"sortBy",className:"block text-sm font-medium text-gray-700"},"Sortuj według"),React.createElement('select',{id:"sortBy",name:"sortBy",value:filters.sortBy,onChange:e=>onFilterChange('sortBy',e.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md"},React.createElement('option',{value:"default"},"Domyślne (Status, Data)"),React.createElement('option',{value:"date_desc"},"Data dodania: najnowsze"),React.createElement('option',{value:"date_asc"},"Data dodania: najstarsze"),React.createElement('option',{value:"price_desc"},"Cena: od najwyższej"),React.createElement('option',{value:"price_asc"},"Cena: od najniższej")))))))}const ToggleButtonGroup=({label,options,selectedValue,onChange, children})=>React.createElement('div',null,React.createElement('label',{className:"block text-sm font-medium text-gray-700 mb-2"},label),React.createElement('div',{className:"flex flex-wrap gap-2"},React.createElement('button',{onClick:()=>onChange('all'),className:`px-3 py-1.5 text-sm rounded-md transition-colors ${selectedValue.length===0?'bg-indigo-600 text-white':'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'}`},"Wszystkie"),options.map(option=>React.createElement('button',{key:option,onClick:()=>onChange(option),className:`px-3 py-1.5 text-sm rounded-md transition-colors ${selectedValue.includes(option)?'bg-indigo-600 text-white':'bg-white text-gray-700 border border-gray-300 hover:bg-gray-50'}`},option))));const SortButton=({label,valueAsc,valueDesc,currentValue,onChange, children})=>React.createElement('div',{className:"flex items-center space-x-2"},React.createElement('span',{className:"text-sm font-medium text-gray-700"},label),React.createElement('div',{className:"flex"},React.createElement('button',{onClick:()=>onChange(valueAsc),className:`p-1 rounded-l-md ${currentValue===valueAsc?'bg-indigo-600 text-white':'bg-white text-gray-500 border border-gray-300 hover:bg-gray-100'}`},React.createElement('svg',{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},React.createElement('path',{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 15l7-7 7 7"}))),React.createElement('button',{onClick:()=>onChange(valueDesc),className:`p-1 rounded-r-md ${currentValue===valueDesc?'bg-indigo-600 text-white':'border-l-0 bg-white text-gray-500 border border-gray-300 hover:bg-gray-100'}`},React.createElement('svg',{xmlns:"http://www.w3.org/2000/svg",className:"h-4 w-4",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},React.createElement('path',{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})))));const FilterHeader=({children})=>React.createElement('div',{className:"flex justify-between items-center"},React.createElement('h3',{className:"text-lg font-medium text-gray-800"},"Filtrowanie i sortowanie"),React.createElement('button',{onClick:()=>setIsExpanded(!isExpanded),className:"flex items-center space-x-1 px-3 py-1.5 text-sm font-medium text-indigo-600 rounded-md hover:bg-indigo-50 focus:outline-none focus:ring-2 focus:ring-offset-1 focus:ring-indigo-500",'aria-expanded':isExpanded},React.createElement('span',null,isExpanded?'Zwiń':'Rozwiń'),React.createElement('svg',{xmlns:"http://www.w3.org/2000/svg",className:`h-5 w-5 transition-transform duration-200 ${isExpanded?'rotate-180':''}`,fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},React.createElement('path',{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"}))));return React.createElement('div',{className:"bg-white p-4 rounded-lg shadow-sm mb-4 animate-fade-in"},React.createElement(FilterHeader,{children:null}),isExpanded&&React.createElement('div',{className:"pt-4 border-t mt-4 space-y-4"},React.createElement(ToggleButtonGroup,{label:"Rodzaj nieruchomości",options:propertyTypes,selectedValue:filters.propertyType,onChange:value=>handleMultiSelectChange('propertyType',value), children:null}),React.createElement(ToggleButtonGroup,{label:"Cel wyceny",options:valuationPurposes,selectedValue:filters.valuationPurpose,onChange:value=>handleMultiSelectChange('valuationPurpose',value), children: null}),React.createElement(ToggleButtonGroup,{label:"Status",options:statuses.filter(s=>s!==ZlecenieStatus.ZAKONCZONE),selectedValue:filters.status,onChange:value=>handleMultiSelectChange('status',value), children: null}),React.createElement('div',{className:"border-t pt-4 flex items-center justify-end space-x-4"},React.createElement(SortButton,{label:"Data",valueAsc:"date_asc",valueDesc:"date_desc",currentValue:filters.sortBy,onChange:value=>onFilterChange('sortBy',value), children: null}),React.createElement(SortButton,{label:"Cena",valueAsc:"price_asc",valueDesc:"price_desc",currentValue:filters.sortBy,onChange:value=>onFilterChange('sortBy',value), children: null}))))};

// ================================================================================= //
// BUNDLED FROM: ALL OTHER COMPONENTS (SubmitOperat, AssignAppraiser, Notifications, etc.)
// ================================================================================= //
const SubmitOperatModal = ({isOpen,onClose,onSubmit,zlecenie,zIndex})=>{const[actualCompletionDate,setActualCompletionDate]=useState('');const[operatFile,setOperatFile]=useState(null);const fileInputRef=useRef(null);const handleSubmit=e=>{e.preventDefault();if(!actualCompletionDate){alert('Proszę podać datę zakończenia.');return}if(!operatFile){alert('Proszę załączyć plik z operatem.');return}onSubmit(actualCompletionDate,operatFile)};const handleFileChange=e=>{if(e.target.files&&e.target.files[0]){setOperatFile(e.target.files[0])}};if(!isOpen||!zlecenie)return null;return React.createElement(Modal,{isOpen:isOpen,onClose:onClose,title:`Przekaż operat dla #${zlecenie.id}`,zIndex:zIndex},React.createElement('form',{onSubmit:handleSubmit,className:"space-y-4"},React.createElement('p',null,"Proszę podać datę ukończenia prac i załączyć gotowy operat szacunkowy. Zlecenie zostanie przekazane do działu rozliczeń."),React.createElement('div',null,React.createElement('label',{htmlFor:"actualCompletionDate",className:"block text-sm font-medium text-gray-700"},"Rzeczywista data zakończenia operatu *"),React.createElement('input',{type:"date",id:"actualCompletionDate",value:actualCompletionDate,onChange:e=>setActualCompletionDate(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",required:true})),React.createElement('div',null,React.createElement('label',{className:"block text-sm font-medium text-gray-700"},"Załącznik z operatem *"),React.createElement('div',{className:"mt-1 flex justify-center px-6 pt-5 pb-6 border-2 border-gray-300 border-dashed rounded-md"},React.createElement('div',{className:"space-y-1 text-center"},React.createElement(PaperClipIcon,{className:"mx-auto h-10 w-10 text-gray-400"}),React.createElement('div',{className:"flex text-sm text-gray-600"},React.createElement('label',{htmlFor:"file-upload",className:"relative cursor-pointer bg-white rounded-md font-medium text-indigo-600 hover:text-indigo-500 focus-within:outline-none focus-within:ring-2 focus-within:ring-offset-2 focus-within:ring-indigo-500"},React.createElement('span',null,"Wybierz plik"),React.createElement('input',{id:"file-upload",name:"file-upload",type:"file",className:"sr-only",onChange:handleFileChange,required:true,ref:fileInputRef})),React.createElement('p',{className:"pl-1"},"lub przeciągnij i upuść")),operatFile?React.createElement('p',{className:"text-sm font-semibold text-green-600"},operatFile.name):React.createElement('p',{className:"text-xs text-gray-500"},"PDF, DOCX, etc. do 10MB")))),React.createElement('div',{className:"flex justify-end pt-4 space-x-2 border-t mt-6"},React.createElement('button',{type:"button",onClick:onClose,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300"},"Anuluj"),React.createElement('button',{type:"submit",className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700"},"Przekaż do rozliczenia"))))};
const AssignAppraiserModal = ({isOpen,onClose,onSubmit,appraisers,title})=>{const[selectedAppraiserId,setSelectedAppraiserId]=useState('');useEffect(()=>{if(!isOpen){setSelectedAppraiserId('')}},[isOpen]);const handleSubmit=e=>{e.preventDefault();if(selectedAppraiserId){onSubmit(selectedAppraiserId)}};return React.createElement(Modal,{isOpen:isOpen,onClose:onClose,title:title,zIndex:1070},React.createElement('form',{onSubmit:handleSubmit,className:"space-y-4"},React.createElement('p',{className:"text-sm text-gray-600"},"Aby zmienić status tego zlecenia, musisz najpierw przypisać do niego rzeczoznawcę."),React.createElement('div',null,React.createElement('label',{htmlFor:"appraiser",className:"block text-sm font-medium text-gray-700"},"Wybierz rzeczoznawcę"),React.createElement('select',{id:"appraiser",value:selectedAppraiserId,onChange:e=>setSelectedAppraiserId(e.target.value),className:"mt-1 block w-full pl-3 pr-10 py-2 text-base border-gray-300 focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm rounded-md",required:true},React.createElement('option',{value:""},"-- Wybierz z listy --"),appraisers.map(user=>React.createElement('option',{key:user.id,value:user.id},user.firstName," ",user.lastName," (",user.email,")")))),React.createElement('div',{className:"flex justify-end pt-4 space-x-2 border-t mt-6"},React.createElement('button',{type:"button",onClick:onClose,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300"},"Anuluj"),React.createElement('button',{type:"submit",disabled:!selectedAppraiserId,className:"px-4 py-2 bg-indigo-600 text-white rounded-md hover:bg-indigo-700 disabled:bg-indigo-300"},"Przypisz i zmień status"))))};
const NotificationsPanel = ({notifications,onMarkAsRead,onMarkAllAsRead,onNavigate})=>{const handleNotificationClick=notification=>{onMarkAsRead(notification.id);if(notification.link){onNavigate(notification.link)}};const hasUnread=notifications.some(n=>!n.isRead);const timeSince=date=>{const seconds=Math.floor((new Date().getTime()-date.getTime())/1000);let interval=seconds/31536000;if(interval>1)return Math.floor(interval)+" lat temu";interval=seconds/2592000;if(interval>1)return Math.floor(interval)+" mies. temu";interval=seconds/86400;if(interval>1)return Math.floor(interval)+" dni temu";interval=seconds/3600;if(interval>1)return Math.floor(interval)+" godz. temu";interval=seconds/60;if(interval>1)return Math.floor(interval)+" min. temu";return"przed chwilą"};return React.createElement('div',{className:"absolute top-16 right-4 w-80 max-w-sm bg-white rounded-lg shadow-xl border z-50 animate-fade-in"},React.createElement('div',{className:"p-3 border-b flex justify-between items-center"},React.createElement('h3',{className:"text-md font-semibold text-gray-800"},"Powiadomienia"),hasUnread&&React.createElement('button',{onClick:onMarkAllAsRead,className:"text-xs text-indigo-600 hover:text-indigo-800 font-medium disabled:text-gray-400 disabled:cursor-not-allowed"},"Oznacz wszystkie jako przeczytane")),React.createElement('div',{className:"max-h-96 overflow-y-auto"},notifications.length===0?React.createElement('p',{className:"text-sm text-gray-500 text-center p-4"},"Brak nowych powiadomień."):React.createElement('ul',{className:"divide-y divide-gray-100"},notifications.map(notification=>React.createElement('li',{key:notification.id,onClick:()=>handleNotificationClick(notification),className:`p-3 cursor-pointer transition-colors ${notification.isRead?'bg-white':'bg-indigo-50'} hover:bg-gray-100`},React.createElement('div',{className:"flex items-start space-x-3"},!notification.isRead&&React.createElement('div',{className:"w-2 h-2 rounded-full bg-indigo-500 mt-1.5 flex-shrink-0"}),React.createElement('div',{className:notification.isRead?'pl-5':''},React.createElement('p',{className:"text-sm text-gray-700"},notification.message),React.createElement('p',{className:"text-xs text-gray-400 mt-1"},timeSince(new Date(notification.timestamp))))))))))};
const CancelOrderModal = ({isOpen,onClose,onSubmit,orderId})=>{const[reason,setReason]=useState('');useEffect(()=>{if(!isOpen){setReason('')}},[isOpen]);const handleSubmit=e=>{e.preventDefault();if(reason.trim()){onSubmit(reason)}else{alert('Proszę podać powód anulowania zlecenia.')}};if(!orderId)return null;return React.createElement(Modal,{isOpen:isOpen,onClose:onClose,title:`Anulowanie zlecenia #${orderId}`},React.createElement('form',{onSubmit:handleSubmit,className:"space-y-4"},React.createElement('div',null,React.createElement('label',{htmlFor:"cancellationReason",className:"block text-sm font-medium text-gray-700"},"Powód anulowania *"),React.createElement('textarea',{id:"cancellationReason",rows:4,value:reason,onChange:e=>setReason(e.target.value),className:"mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-indigo-500 focus:border-indigo-500 sm:text-sm",placeholder:"Np. Klient zrezygnował, brak kontaktu z klientem...",required:true})),React.createElement('div',{className:"flex justify-end pt-4 space-x-2 border-t"},React.createElement('button',{type:"button",onClick:onClose,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-md hover:bg-gray-300"},"Zamknij"),React.createElement('button',{type:"submit",className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700"},"Potwierdź anulowanie"))))};

// ================================================================================= //
// BUNDLED FROM: App.tsx
// ================================================================================= //
const AppContent = ()=>{const[users,setUsers]=useState(MOCK_USERS);const[zlecenia,setZlecenia]=useState(MOCK_ZLECENIA);const[currentUser,setCurrentUser]=useState(null);const[loginError,setLoginError]=useState(null);const[subcontractorTab,setSubcontractorTab]=useState('gielda');const[selectedZlecenie,setSelectedZlecenie]=useState(null);const[isZlecenieFormOpen,setIsZlecenieFormOpen]=useState(false);const[isZlecenieDetailsOpen,setIsZlecenieDetailsOpen]=useState(false);const[isAppraiserResponseFormOpen,setIsAppraiserResponseFormOpen]=useState(false);const[isSettingsOpen,setIsSettingsOpen]=useState(false);const[isSubmitOperatModalOpen,setIsSubmitOperatModalOpen]=useState(false);const[isAssignAppraiserModalOpen,setIsAssignAppraiserModalOpen]=useState(false);const[isNotificationsOpen,setIsNotificationsOpen]=useState(false);const[isCancelModalOpen,setIsCancelModalOpen]=useState(false);const[zlecenieToCancel,setZlecenieToCancel]=useState(null);const[zlecenieToUpdateStatus,setZlecenieToUpdateStatus]=useState(null);const[notifications,setNotifications]=useState([]);const[auditLog,setAuditLog]=useState([]);const{addNotification}=useNotification();const[filters,setFilters]=useState({propertyType:[],valuationPurpose:[],location:'',voivodeship:'all',status:[],sortBy:'default',quickSearch:'',assignedAppraiserId:'all'});const addAuditLog=(action,details)=>{const newEntry={id:`log-${Date.now()}`,timestamp:new Date().toISOString(),userId:currentUser.id,userEmail:currentUser.email,action,details};setAuditLog(prev=>[newEntry,...prev])};const handleLogin=(email,password)=>{const user=users.find(u=>u.email===email&&u.password===password);if(user){setCurrentUser(user)}else{setLoginError('Nieprawidłowy email lub hasło.')}};const handleLogout=()=>{setCurrentUser(null)};const handleFilterChange=(name,value)=>{setFilters(prev=>({...prev,[name]:value}))};const isInternalUser=currentUser?.role===UserRole.ADMIN||currentUser?.role===UserRole.PRACOWNIK;const filteredZlecenia=useMemo(()=>{let filtered=[...zlecenia];const isAppraiser=currentUser?.role===UserRole.RZECZOZNAWCA;if(isAppraiser){if(subcontractorTab==='gielda'){filtered=filtered.filter(o=>o.status===ZlecenieStatus.NOWE);if(currentUser.assignedVoivodeships&&currentUser.assignedVoivodeships.length>0){filtered=filtered.filter(o=>o.voivodeship&&currentUser.assignedVoivodeships?.includes(o.voivodeship))}}else{filtered=filtered.filter(o=>o.assignedAppraiserId===currentUser?.id)}}if(filters.propertyType.length>0){filtered=filtered.filter(o=>filters.propertyType.includes(o.propertyType))}if(filters.valuationPurpose.length>0){filtered=filtered.filter(o=>filters.valuationPurpose.includes(o.valuationPurpose))}if(filters.status.length>0){filtered=filtered.filter(o=>filters.status.includes(o.status))}return filtered.sort((a,b)=>{const dateA=new Date(a.publicationDate||a.creationDate).getTime();const dateB=new Date(b.publicationDate||b.creationDate).getTime();switch(filters.sortBy){case'date_asc':return dateA-dateB;case'date_desc':return dateB-dateA;case'price_asc':return(a.proposedPrice||0)-(b.proposedPrice||0);case'price_desc':return(b.proposedPrice||0)-(a.proposedPrice||0);default:return dateB-dateA}})},[zlecenia,filters,currentUser,subcontractorTab]);useEffect(()=>{if(filteredZlecenia.length>0&&!filteredZlecenia.find(o=>o.id===selectedZlecenie?.id)){setSelectedZlecenie(null)}else if(filteredZlecenia.length===0){setSelectedZlecenie(null)}},[filteredZlecenia,selectedZlecenie?.id]);const handleAddOrUpdateZlecenie=(data,id)=>{if(id){const updatedZlecenie={...zlecenia.find(o=>o.id===id),...data};setZlecenia(zlecenia.map(o=>o.id===id?updatedZlecenie:o));addNotification(`Zlecenie #${id} zaktualizowane.`,'success');addAuditLog('Zaktualizowano zlecenie',`Zlecenie #${id}`);setSelectedZlecenie(updatedZlecenie)}else{const newLead={id:`L${Date.now()}`,creationDate:new Date().toISOString(),status:ZlecenieStatus.LEAD,communicationLog:[{id:`log-${Date.now()}`,date:new Date().toISOString(),author:'System',content:'Lead utworzony.'}],attachments:[],responses:[],...data};setZlecenia(prev=>[newLead,...prev]);addNotification(`Dodano nowego leada #${newLead.id}`,'success');addAuditLog('Utworzono leada',`Lead #${newLead.id}`)}setIsZlecenieFormOpen(false)};const handleAddUser=user=>{if(users.find(u=>u.id===user.id)){setUsers(users.map(u=>u.id===user.id?{...u,...user}:u));addNotification(`Zaktualizowano użytkownika ${user.email}`,'success');addAuditLog('Zaktualizowano użytkownika',`Użytkownik ${user.email}`)}else{const newUser={...user,id:`user-${Date.now()}`};setUsers(prev=>[...prev,newUser]);addNotification(`Dodano użytkownika ${newUser.email}`,'success');addAuditLog('Dodano użytkownika',`Użytkownik ${newUser.email}`)}};const handleUpdateUser=updatedUser=>{setUsers(users.map(u=>u.id===updatedUser.id?updatedUser:u));if(currentUser?.id===updatedUser.id){setCurrentUser(updatedUser)}addNotification('Twoje ustawienia zostały zapisane.','success')};const handleAddAppraiserResponse=response=>{const newResponse={...response,id:`resp-${Date.now()}`,authorId:currentUser.id,author:currentUser.email};const updatedZlecenie={...selectedZlecenie,status:ZlecenieStatus.ZAREZERWOWANE,responses:[...selectedZlecenie.responses,newResponse],communicationLog:[...selectedZlecenie.communicationLog,{id:`log-${Date.now()}`,date:new Date().toISOString(),author:'System',content:`Rzeczoznawca ${currentUser.email} odpowiedział na zlecenie.`}]};setZlecenia(zlecenia.map(o=>o.id===selectedZlecenie.id?updatedZlecenie:o));setSelectedZlecenie(updatedZlecenie);addNotification('Twoja odpowiedź została wysłana.','success');setIsAppraiserResponseFormOpen(false)};const handleUpdateStatus=(zlecenieId,newStatus)=>{const zlecenie=zlecenia.find(o=>o.id===zlecenieId);const oldStatus=zlecenie.status;if(newStatus===oldStatus)return;if(newStatus===ZlecenieStatus.ANULOWANE){setZlecenieToCancel(zlecenie);setIsCancelModalOpen(true);return}if((newStatus===ZlecenieStatus.W_TRAKCIE||newStatus===ZlecenieStatus.DO_ROZLICZENIA)&&!zlecenie.assignedAppraiserId){setZlecenieToUpdateStatus({zlecenieId,newStatus});setIsAssignAppraiserModalOpen(true);return}const statusChangeLog={id:`log-${Date.now()}`,date:new Date().toISOString(),author:'System',content:`Zmieniono status z '${oldStatus}' na '${newStatus}'.`};let updatedZlecenie={...zlecenie,status:newStatus,communicationLog:[...zlecenie.communicationLog,statusChangeLog]};if(newStatus===ZlecenieStatus.DO_ROZLICZENIA&&!updatedZlecenie.settlementChecklist){updatedZlecenie.settlementChecklist={operatPobrany:!!zlecenie.attachments.find(file=>file.id.startsWith('file-operat-')),fakturaWystawiona:false,fakturaOplacona:false,operatPrzekazany:false,rozliczonoZRzeczoznawca:false}}setZlecenia(zlecenia.map(o=>o.id===zlecenieId?updatedZlecenie:o));if(selectedZlecenie?.id===zlecenieId)setSelectedZlecenie(updatedZlecenie);addNotification(`Status zlecenia #${zlecenieId} zmieniono na: ${newStatus}`,'info');addAuditLog('Zmiana statusu zlecenia',`Zlecenie #${zlecenieId}: ${oldStatus} -> ${newStatus}`)};const handleConfirmCancelZlecenie=reason=>{if(!zlecenieToCancel)return;const oldStatus=zlecenieToCancel.status;const statusChangeLog={id:`log-${Date.now()}`,date:new Date().toISOString(),author:'System',content:`Zmieniono status z '${oldStatus}' na 'Anulowane'.`};const reasonLog={id:`log-${Date.now()}-reason`,date:new Date().toISOString(),author:'System',content:`Powód anulowania: ${reason}`};const updatedZlecenie={...zlecenieToCancel,status:ZlecenieStatus.ANULOWANE,communicationLog:[...zlecenieToCancel.communicationLog,statusChangeLog,reasonLog]};setZlecenia(zlecenia.map(o=>o.id===zlecenieToCancel.id?updatedZlecenie:o));if(selectedZlecenie?.id===zlecenieToCancel.id)setSelectedZlecenie(updatedZlecenie);addNotification(`Zlecenie #${zlecenieToCancel.id} zostało anulowane.`,'info');addAuditLog('Anulowano zlecenie',`Zlecenie #${zlecenieToCancel.id}`);setIsCancelModalOpen(false);setZlecenieToCancel(null)};const handleAssignAndChangeStatus=appraiserId=>{const{zlecenieId,newStatus}=zlecenieToUpdateStatus;const zlecenie=zlecenia.find(o=>o.id===zlecenieId);const oldStatus=zlecenie.status;const assignmentLog={id:`log-${Date.now()}-assign`,date:new Date().toISOString(),author:'System',content:`Przypisano rzeczoznawcę: ${users.find(u=>u.id===appraiserId)?.email}.`};const statusChangeLog={id:`log-${Date.now()}-status`,date:new Date().toISOString(),author:'System',content:`Zmieniono status z '${oldStatus}' na '${newStatus}'.`};let updatedZlecenie={...zlecenie,status:newStatus,assignedAppraiserId:appraiserId,communicationLog:[...zlecenie.communicationLog,assignmentLog,statusChangeLog]};if(newStatus===ZlecenieStatus.DO_ROZLICZENIA&&!updatedZlecenie.settlementChecklist){updatedZlecenie.settlementChecklist={operatPobrany:!!zlecenie.attachments.find(file=>file.id.startsWith('file-operat-')),fakturaWystawiona:false,fakturaOplacona:false,operatPrzekazany:false,rozliczonoZRzeczoznawca:false}}setZlecenia(zlecenia.map(o=>o.id===zlecenieId?updatedZlecenie:o));if(selectedZlecenie?.id===zlecenieId)setSelectedZlecenie(updatedZlecenie);addNotification(`Status zlecenia #${zlecenieId} zmieniono na: ${newStatus}`,'info');addAuditLog('Przypisano rzeczoznawcę i zmieniono status',`Zlecenie #${zlecenieId} -> ${newStatus}`);setIsAssignAppraiserModalOpen(false);setZlecenieToUpdateStatus(null)};const handleAddCommunicationEntry=content=>{const newEntry={id:`log-${Date.now()}`,date:new Date().toISOString(),author:currentUser.email,content};const updatedZlecenie={...selectedZlecenie,communicationLog:[...selectedZlecenie.communicationLog,newEntry]};setZlecenia(zlecenia.map(z=>z.id===selectedZlecenie.id?updatedZlecenie:z));setSelectedZlecenie(updatedZlecenie)};const handleAttachFile=(zlecenieId,file)=>{const newAttachment={id:`file-${Date.now()}`,name:file.name,size:file.size,type:file.type,url:URL.createObjectURL(file),uploadedAt:new Date().toISOString()};const updatedZlecenie={...zlecenia.find(o=>o.id===zlecenieId),attachments:[...zlecenia.find(o=>o.id===zlecenieId).attachments,newAttachment]};setZlecenia(zlecenia.map(o=>o.id===zlecenieId?updatedZlecenie:o));if(selectedZlecenie?.id===zlecenieId)setSelectedZlecenie(updatedZlecenie);addNotification(`Dołączono plik: ${file.name}`,'success')};const handleSubmitOperat=(actualCompletionDate,file)=>{const zlecenie=selectedZlecenie;const oldStatus=zlecenie.status;const newStatus=ZlecenieStatus.DO_ROZLICZENIA;const operatAttachment={id:`file-operat-${Date.now()}`,name:file.name,size:file.size,type:file.type,url:URL.createObjectURL(file),uploadedAt:new Date().toISOString()};const operatLog={id:`log-${Date.now()}-operat`,date:new Date().toISOString(),author:'System',content:`Rzeczoznawca przekazał operat.`};const statusLog={id:`log-${Date.now()}-status`,date:new Date().toISOString(),author:'System',content:`Zmieniono status z '${oldStatus}' na '${newStatus}'.`};const updatedZlecenie={...zlecenie,status:newStatus,actualCompletionDate,attachments:[...zlecenie.attachments,operatAttachment],settlementChecklist:{operatPobrany:true,fakturaWystawiona:false,fakturaOplacona:false,operatPrzekazany:false,rozliczonoZRzeczoznawca:false},communicationLog:[...zlecenie.communicationLog,operatLog,statusLog]};setZlecenia(zlecenia.map(o=>o.id===zlecenie.id?updatedZlecenie:o));setSelectedZlecenie(updatedZlecenie);addNotification('Operat został przekazany do rozliczenia','success');setIsSubmitOperatModalOpen(false)};const handleUpdateSettlementChecklist=(zlecenieId,checklistItem,value)=>{setZlecenia(prev=>prev.map(o=>{if(o.id===zlecenieId&&o.settlementChecklist){const updatedChecklist={...o.settlementChecklist,[checklistItem]:value};const updatedZlecenie={...o,settlementChecklist:updatedChecklist};if(selectedZlecenie?.id===zlecenieId)setSelectedZlecenie(updatedZlecenie);return updatedZlecenie}return o}));addNotification(`Checklista dla zlecenia #${zlecenieId} została zaktualizowana.`,'info')};const handleFinalizeZlecenie=zlecenieId=>{const zlecenie=zlecenia.find(o=>o.id===zlecenieId);const oldStatus=zlecenie.status;const finalizationLog={id:`log-${Date.now()}-finalize`,date:new Date().toISOString(),author:'System',content:`Zlecenie zostało zakończone i zarchiwizowane.`};const statusLog={id:`log-${Date.now()}-status`,date:new Date().toISOString(),author:'System',content:`Zmieniono status z '${oldStatus}' na '${ZlecenieStatus.ZAKONCZONE}'.`};const updatedZlecenie={...zlecenie,status:ZlecenieStatus.ZAKONCZONE,communicationLog:[...zlecenie.communicationLog,statusLog,finalizationLog]};setZlecenia(zlecenia.map(o=>o.id===zlecenieId?updatedZlecenie:o));setSelectedZlecenie(null);setIsZlecenieDetailsOpen(false);addNotification(`Zlecenie #${zlecenieId} zostało zakończone.`,'success');addAuditLog('Zakończono zlecenie',`Zlecenie #${zlecenieId}`)};if(!currentUser){return React.createElement(Login,{onLogin:handleLogin,error:loginError})}return React.createElement('div',{className:"h-screen w-screen bg-gray-100 flex flex-col font-sans"},React.createElement('header',{className:"bg-white shadow-sm p-3 flex justify-between items-center flex-shrink-0 z-20"},React.createElement('h1',{className:"text-xl font-bold text-gray-800"},"Operaty24.pl"),React.createElement('div',{className:"flex items-center space-x-4"},React.createElement('span',{className:"text-sm text-gray-600"},"Zalogowano jako: ",React.createElement('span',{className:"font-semibold"},currentUser.email)," (",currentUser.role,")"),React.createElement('div',{className:"flex items-center space-x-2"},React.createElement('button',{onClick:()=>setIsNotificationsOpen(p=>!p),className:"relative p-2 rounded-full hover:bg-gray-100 text-gray-500 hover:text-gray-800"},React.createElement(BellIcon,{className:"w-6 h-6"}),notifications.some(n=>!n.isRead)&&React.createElement('span',{className:"absolute top-2 right-2 block w-2 h-2 bg-indigo-500 rounded-full"})),React.createElement('button',{onClick:()=>setIsSettingsOpen(true),className:"p-2 rounded-full hover:bg-gray-100 text-gray-500 hover:text-gray-800"},React.createElement(Cog6ToothIcon,{className:"w-6 h-6"})),React.createElement('button',{onClick:handleLogout,className:"p-2 rounded-full hover:bg-gray-100 text-gray-500 hover:text-gray-800"},React.createElement(ArrowRightStartOnRectangleIcon,{className:"w-6 h-6"}))))),React.createElement('main',{className:"flex-grow p-4 overflow-hidden relative"},isInternalUser?React.createElement(React.Fragment,null,React.createElement(KanbanBoard,{zlecenia:zlecenia.filter(z=>z.status!==ZlecenieStatus.ZAKONCZONE&&z.status!==ZlecenieStatus.ANULOWANE),onCardClick:zlecenie=>{setSelectedZlecenie(zlecenie);setIsZlecenieDetailsOpen(true)},onAddLeadClick:()=>{setSelectedZlecenie(null);setIsZlecenieFormOpen(true)}}),React.createElement('button',{onClick:()=>{setSelectedZlecenie(null);setIsZlecenieFormOpen(true)},className:"fixed bottom-6 right-6 bg-indigo-600 text-white rounded-full p-4 shadow-lg hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 transition-transform hover:scale-105",'aria-label':"Dodaj nowego leada"},React.createElement(PlusCircleIcon,{className:"w-8 h-8"}))):React.createElement('div',{className:"h-full flex flex-col"},React.createElement('div',{className:"flex-shrink-0 mb-4"},React.createElement('div',{className:"flex space-x-1 bg-gray-200 p-1 rounded-lg max-w-xs"},React.createElement('button',{onClick:()=>setSubcontractorTab('gielda'),className:`w-full text-center px-4 py-1.5 text-sm font-semibold rounded-md transition-colors ${subcontractorTab==='gielda'?'bg-white text-gray-800 shadow-sm':'text-gray-600'}`},"Giełda Zleceń"),React.createElement('button',{onClick:()=>setSubcontractorTab('moje'),className:`w-full text-center px-4 py-1.5 text-sm font-semibold rounded-md transition-colors ${subcontractorTab==='moje'?'bg-white text-gray-800 shadow-sm':'text-gray-600'}`},"Moje Zlecenia"))),React.createElement('div',{className:"flex-grow grid grid-cols-12 gap-4 overflow-hidden"},React.createElement('div',{className:"col-span-4 flex flex-col"},React.createElement(FilterControls,{filters:filters,onFilterChange:handleFilterChange,propertyTypes:PROPERTY_TYPES,valuationPurposes:VALUATION_PURPOSES,statuses:ZLECENIE_STATUSES,currentUser:currentUser,users:users}),React.createElement('div',{className:"flex-grow overflow-y-auto pr-2 mt-4 space-y-3"},filteredZlecenia.map(z=>React.createElement(ZlecenieCard,{key:z.id,zlecenie:z,onClick:setSelectedZlecenie})))),React.createElement('div',{className:"col-span-5 bg-white rounded-lg shadow-sm overflow-hidden"},selectedZlecenie?React.createElement(ZlecenieDetails,{zlecenie:selectedZlecenie,currentUser:currentUser,users:users,onEdit:()=>{},onUpdateStatus:()=>{},onAddCommunicationEntry:handleAddCommunicationEntry,onAttachFile:handleAttachFile,onDeleteFile:()=>{},onSubmitOperat:()=>setIsSubmitOperatModalOpen(true),onUpdateSubStatus:(id,status)=>setZlecenia(zlecenia.map(o=>o.id===id?{...o,subStatus:status}:o)),onUpdateSettlementChecklist:handleUpdateSettlementChecklist,onFinalize:handleFinalizeZlecenie,activeSubcontractorTab:subcontractorTab}):React.createElement('div',{className:"flex flex-col items-center justify-center h-full text-center text-gray-500 p-4"},React.createElement(DocumentMagnifyingGlassIcon,{className:"w-16 h-16 text-gray-300"}),React.createElement('h3',{className:"mt-4 text-lg font-medium"},"Wybierz zlecenie"),React.createElement('p',{className:"mt-1 text-sm"},"Zaznacz zlecenie z listy, aby zobaczyć jego szczegóły."))),React.createElement('div',{className:"col-span-3"},React.createElement(OrderMap,{zlecenia:filteredZlecenia,selectedZlecenie:selectedZlecenie,currentUser:currentUser}))))),React.createElement(Modal,{isOpen:isZlecenieFormOpen,onClose:()=>setIsZlecenieFormOpen(false),title:selectedZlecenie?`Edytuj Zlecenie #${selectedZlecenie.id}`:'Dodaj Nowego Leada',size:"xl"},React.createElement(ZlecenieForm,{onSubmit:handleAddOrUpdateZlecenie,onClose:()=>setIsZlecenieFormOpen(false),propertyTypes:PROPERTY_TYPES,valuationPurposes:VALUATION_PURPOSES,appraisalForms:APPRAISAL_FORMS,initialData:selectedZlecenie})),React.createElement(Modal,{isOpen:isZlecenieDetailsOpen,onClose:()=>setIsZlecenieDetailsOpen(false),title:"Szczegóły zlecenia",size:"2xl"},selectedZlecenie&&React.createElement(ZlecenieDetails,{zlecenie:selectedZlecenie,currentUser:currentUser,users:users,onEdit:z=>{setIsZlecenieDetailsOpen(false);setSelectedZlecenie(z);setIsZlecenieFormOpen(true)},onUpdateStatus:handleUpdateStatus,onAddCommunicationEntry:handleAddCommunicationEntry,onAttachFile:handleAttachFile,onDeleteFile:()=>{},onSubmitOperat:()=>{},onUpdateSubStatus:(id,status)=>setZlecenia(zlecenia.map(o=>o.id===id?{...o,subStatus:status}:o)),onUpdateSettlementChecklist:handleUpdateSettlementChecklist,onFinalize:handleFinalizeZlecenie, activeSubcontractorTab:undefined})),selectedZlecenie&&React.createElement(Modal,{isOpen:isAppraiserResponseFormOpen,onClose:()=>setIsAppraiserResponseFormOpen(false),title:"Odpowiedz na zlecenie"},React.createElement(AppraiserResponseForm,{zlecenie:selectedZlecenie,onSubmit:handleAddAppraiserResponse,onClose:()=>setIsAppraiserResponseFormOpen(false)})),isSettingsOpen&&React.createElement(Modal,{isOpen:isSettingsOpen,onClose:()=>setIsSettingsOpen(false),title:"Ustawienia",size:"2xl"},React.createElement('div', null, 'Settings will be implemented here')),React.createElement(SubmitOperatModal,{isOpen:isSubmitOperatModalOpen,onClose:()=>setIsSubmitOperatModalOpen(false),onSubmit:handleSubmitOperat,zlecenie:selectedZlecenie, zIndex:1060}),React.createElement(AssignAppraiserModal,{isOpen:isAssignAppraiserModalOpen,onClose:()=>setIsAssignAppraiserModalOpen(false),onSubmit:handleAssignAndChangeStatus,appraisers:users.filter(u=>u.role===UserRole.RZECZOZNAWCA),title:"Przypisz rzeczoznawcę"}),React.createElement(CancelOrderModal,{isOpen:isCancelModalOpen,onClose:()=>setIsCancelModalOpen(false),onSubmit:handleConfirmCancelZlecenie,orderId:zlecenieToCancel?.id||null}))};

const App = ()=>(React.createElement(NotificationProvider,null,React.createElement(AppContent,null)));

// ================================================================================= //
// RENDER CALL
// ================================================================================= //
const rootElement = document.getElementById('root');
if (!rootElement) {
  throw new Error("Could not find root element to mount to");
}
const root = ReactDOM.createRoot(rootElement);
root.render(
  React.createElement(React.StrictMode, null, React.createElement(App, null))
);
